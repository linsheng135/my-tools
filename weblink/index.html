<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ä¸ªäººå¯¼èˆªé¡µ | é“¾æ¥ç®¡ç†å™¨</title>
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ”—</text></svg>">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #4f46e5;
      --secondary-color: #7c3aed;
      --background-color: #f8fafc;
      --card-color: #ffffff;
      --text-color: #1e293b;
      --text-secondary: #64748b;
      --border-color: #e2e8f0;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
      --export-color: #0ea5e9;
      --select-color: #10b981;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --radius: 12px;
    }

    .dark-mode {
      --primary-color: #6366f1;
      --secondary-color: #8b5cf6;
      --background-color: #0f172a;
      --card-color: #1e293b;
      --text-color: #f1f5f9;
      --text-secondary: #94a3b8;
      --border-color: #334155;
      --export-color: #38bdf8;
      --select-color: #34d399;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: var(--background-color);
      color: var(--text-color);
      min-height: 100vh;
      padding: 0;
      line-height: 1.5;
      transition: background-color 0.3s ease;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
      flex-wrap: wrap;
      gap: 15px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 22px;
      font-weight: 700;
      color: var(--primary-color);
    }

    .logo i {
      font-size: 24px;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 16px;
      border-radius: var(--radius);
      border: none;
      background: var(--primary-color);
      color: white;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      font-size: 14px;
      white-space: nowrap;
    }

    .btn:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .btn-secondary {
      background: var(--card-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: #f1f5f9;
      border-color: var(--primary-color);
    }

    .dark-mode .btn-secondary:hover {
      background: #334155;
    }

    .btn-export {
      background: var(--export-color);
      color: white;
    }

    .btn-export:hover {
      background: #0284c7;
    }

    .btn-select {
      background: var(--select-color);
      color: white;
    }

    .btn-select:hover {
      background: #059669;
    }

    .btn-danger {
      background: var(--danger-color);
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-warning {
      background: var(--warning-color);
      color: white;
    }

    .btn-warning:hover {
      background: #d97706;
    }

    .btn-small {
      padding: 6px 12px;
      font-size: 13px;
    }

    .btn-icon {
      padding: 10px;
      width: 40px;
      height: 40px;
      justify-content: center;
    }

    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 18px;
      margin-bottom: 30px;
    }

    @media (max-width: 768px) {
      .content-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
      }
    }

    @media (max-width: 480px) {
      .content-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }
    }

    .folder-card {
      background: var(--card-color);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      min-height: 150px;
    }

    .folder-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      border-color: var(--primary-color);
    }

    .folder-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 12px;
      flex: 1;
    }

    .folder-info {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      min-width: 0;
    }

    .folder-icon {
      width: 44px;
      height: 44px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 18px;
      flex-shrink: 0;
    }

    .folder-text {
      min-width: 0;
      flex: 1;
    }

    .folder-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .folder-desc {
      color: var(--text-secondary);
      font-size: 13px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      line-height: 1.4;
      max-height: 2.8em;
    }

    .folder-stats {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: auto;
      font-size: 12px;
      color: var(--text-secondary);
      padding-top: 12px;
      border-top: 1px solid var(--border-color);
    }

    .folder-actions {
      display: flex;
      gap: 6px;
      flex-shrink: 0;
    }

    .links-container {
      background: var(--card-color);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
      margin-bottom: 30px;
      display: none;
    }

    .links-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .links-header h2 {
      font-size: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* æ‰¹é‡æ“ä½œæ æ ·å¼ */
    .bulk-actions-bar {
      display: none;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 15px 20px;
      background: var(--card-color);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 2px solid var(--select-color);
      flex-wrap: wrap;
      gap: 15px;
      transition: all 0.3s ease;
    }

    .bulk-actions-bar.active {
      display: flex;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .bulk-selection-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .selected-count {
      font-weight: 600;
      color: var(--select-color);
      font-size: 16px;
    }

    .bulk-actions-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .links-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
    }

    @media (max-width: 768px) {
      .links-list {
        grid-template-columns: 1fr;
      }

      .bulk-actions-bar {
        flex-direction: column;
        align-items: flex-start;
      }

      .bulk-actions-buttons {
        width: 100%;
        justify-content: space-between;
      }
    }

    .link-card {
      background: var(--background-color);
      border-radius: var(--radius);
      padding: 16px;
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      position: relative;
      cursor: default;
    }

    .link-card:hover {
      background: var(--card-color);
      border-color: var(--primary-color);
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .link-card.selected {
      border-color: var(--select-color);
      border-width: 2px;
      background: rgba(16, 185, 129, 0.05);
    }

    .dark-mode .link-card.selected {
      background: rgba(16, 185, 129, 0.1);
    }

    .link-checkbox {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: var(--select-color);
      z-index: 2;
    }

    .link-header {
      display: flex;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .link-icon-container {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
      font-size: 16px;
      color: var(--primary-color);
      border: 1px solid var(--border-color);
      overflow: hidden;
      flex-shrink: 0;
    }

    .link-icon-container img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .link-title-container {
      flex: 1;
      min-width: 0;
      margin-right: 25px; /* ä¸ºå¤é€‰æ¡†ç•™å‡ºç©ºé—´ */
    }

    .link-title {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .link-url {
      font-size: 12px;
      color: var(--text-secondary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      margin-bottom: 6px;
    }

    .link-notes {
      font-size: 13px;
      color: var(--text-color);
      line-height: 1.5;
      margin-top: 10px;
      padding: 10px;
      background: rgba(99, 102, 241, 0.05);
      border-radius: 6px;
      border-left: 3px solid var(--primary-color);
    }

    .link-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      justify-content: flex-end;
    }

    .empty-state {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 15px;
      color: #cbd5e1;
    }

    .empty-state h3 {
      font-size: 20px;
      margin-bottom: 10px;
      color: var(--text-color);
    }

    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      padding: 20px;
    }

    .modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-color);
      border-radius: var(--radius);
      padding: 24px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: translateY(20px);
      transition: all 0.3s ease;
    }

    .modal.active .modal-content {
      transform: translateY(0);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 600;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .modal-close:hover {
      color: var(--danger-color);
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
    }

    .form-input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: var(--card-color);
      color: var(--text-color);
      font-size: 15px;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: var(--card-color);
      color: var(--text-color);
      font-size: 15px;
      transition: all 0.3s ease;
      resize: vertical;
      min-height: 80px;
      font-family: inherit;
    }

    .form-textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 25px;
    }

    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-color);
      border-radius: var(--radius);
      padding: 14px 18px;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      gap: 10px;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 100;
      max-width: 90vw;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    .notification.success {
      border-left: 4px solid var(--success-color);
    }

    .notification.error {
      border-left: 4px solid var(--danger-color);
    }

    .notification.warning {
      border-left: 4px solid var(--warning-color);
    }

    .sync-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: 20px;
      background: rgba(99, 102, 241, 0.1);
      color: var(--primary-color);
    }

    .theme-toggle {
      background: var(--card-color);
      border: 1px solid var(--border-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(30deg);
    }

    .stats-footer {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 25px;
      padding-top: 25px;
      border-top: 1px solid var(--border-color);
    }

    .stat-item {
      text-align: center;
      padding: 12px;
      background: var(--card-color);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 13px;
      color: var(--text-secondary);
    }

    .footer {
      text-align: center;
      padding: 25px 0 15px;
      color: var(--text-secondary);
      font-size: 14px;
      margin-top: 20px;
    }

    .back-btn {
      background: var(--card-color);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      padding: 10px 16px;
      color: var(--text-color);
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      margin-bottom: 15px;
      width: 100%;
      justify-content: center;
    }

    .back-btn:hover {
      background: #f1f5f9;
      border-color: var(--primary-color);
    }

    .dark-mode .back-btn:hover {
      background: #334155;
    }

    .search-container {
      margin-bottom: 20px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 14px 18px;
      padding-left: 50px;
      border-radius: var(--radius);
      border: 1px solid var(--border-color);
      background: var(--card-color);
      color: var(--text-color);
      font-size: 15px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .search-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 16px;
    }

    .quick-actions {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .header-actions {
        width: 100%;
        justify-content: space-between;
      }

      .btn {
        padding: 8px 14px;
        font-size: 14px;
      }

      .folder-card {
        padding: 16px;
        min-height: 150px;
      }

      .folder-icon {
        width: 40px;
        height: 40px;
        font-size: 16px;
      }

      .folder-title {
        font-size: 15px;
      }

      .links-container {
        padding: 16px;
      }

      .links-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .links-header h2 {
        font-size: 18px;
      }

      .stats-footer {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }

      .stat-item {
        padding: 10px;
      }

      .stat-value {
        font-size: 20px;
      }

      .modal-content {
        padding: 20px;
      }
    }

    @media (max-width: 480px) {
      .content-grid {
        gap: 10px;
      }

      .folder-card {
        padding: 14px;
        min-height: 140px;
      }

      .folder-icon {
        width: 36px;
        height: 36px;
        font-size: 14px;
      }

      .header-actions {
        gap: 8px;
      }

      .btn {
        padding: 8px 12px;
        font-size: 13px;
      }

      .stats-footer {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .stat-item {
        padding: 8px;
      }

      .stat-value {
        font-size: 18px;
      }

      .footer {
        padding: 20px 0 10px;
        font-size: 12px;
      }
    }

    @media (hover: none) and (pointer: coarse) {
      .folder-card:hover {
        transform: none;
      }

      .link-card:hover {
        transform: none;
      }

      .btn:hover {
        transform: none;
      }

      .folder-card:active {
        transform: scale(0.98);
      }

      .link-card:active {
        transform: scale(0.98);
      }

      .btn:active {
        transform: scale(0.98);
      }
    }

    /* æ–°å¢æ ·å¼ */
    .breadcrumb {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
      font-size: 14px;
    }

    .breadcrumb-item {
      padding: 6px 12px;
      border-radius: 20px;
      background: var(--card-color);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .breadcrumb-item:hover {
      background: var(--background-color);
      border-color: var(--primary-color);
    }

    .breadcrumb-item.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
      cursor: default;
    }

    .breadcrumb-separator {
      color: var(--text-secondary);
    }

    .confirm-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }

    .confirm-text {
      padding: 15px 0;
      line-height: 1.6;
    }

    /* ç§»åŠ¨é“¾æ¥æ¨¡æ€æ¡†ä¸“ç”¨æ ·å¼ */
    .move-links-info {
      padding: 10px;
      background: rgba(16, 185, 129, 0.1);
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 14px;
    }

    /* é€‰æ‹©æ¨¡å¼æç¤º */
    .selection-mode-hint {
      padding: 10px;
      background: rgba(99, 102, 241, 0.1);
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 14px;
      color: var(--primary-color);
      text-align: center;
    }

    /* æ‰“å¼€é“¾æ¥ç¡®è®¤æ¨¡æ€æ¡†æ ·å¼ */
    .open-links-list {
      max-height: 300px;
      overflow-y: auto;
      margin: 15px 0;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 10px;
    }

    .open-links-item {
      padding: 10px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .open-links-item:last-child {
      border-bottom: none;
    }

    .open-links-item-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    .open-links-item-text {
      flex: 1;
      min-width: 0;
    }

    .open-links-item-name {
      font-weight: 500;
      font-size: 14px;
      margin-bottom: 2px;
    }

    .open-links-item-url {
      font-size: 12px;
      color: var(--text-secondary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="header">
      <div class="logo">
        <i class="fas fa-compass"></i>
        <span>ä¸ªäººå¯¼èˆª</span>
      </div>
      <div class="header-actions">
        <button class="btn" id="addFolderBtn">
          <i class="fas fa-folder-plus"></i>
          <span class="desktop-only">æ–°å»ºæ–‡ä»¶å¤¹</span>
        </button>
        <button class="btn" id="addLinkBtn">
          <i class="fas fa-plus"></i>
          <span class="desktop-only">æ·»åŠ é“¾æ¥</span>
        </button>
        <button class="btn btn-export" id="exportAllBtn">
          <i class="fas fa-file-export"></i>
          <span class="desktop-only">å¯¼å‡ºé“¾æ¥</span>
        </button>
        <div class="theme-toggle" id="themeToggle">
          <i class="fas fa-moon" id="themeIcon"></i>
        </div>
        <button class="btn btn-icon" id="settingsBtn">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </header>

    <!-- æœç´¢æ¡† -->
    <div class="search-container">
      <i class="fas fa-search search-icon"></i>
      <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢æ–‡ä»¶å¤¹æˆ–é“¾æ¥...">
    </div>

    <!-- å¿«é€Ÿæ“ä½œæ  -->
    <div class="quick-actions" id="quickActions"></div>

    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb" id="breadcrumb">
      <div class="breadcrumb-item active" data-id="">æ ¹ç›®å½•</div>
    </div>

    <!-- æ‰¹é‡æ“ä½œæ  -->
    <div class="bulk-actions-bar" id="bulkActionsBar">
      <div class="bulk-selection-info">
        <span class="selected-count" id="selectedCount">å·²é€‰æ‹© 0 ä¸ªé“¾æ¥</span>
      </div>
      <div class="bulk-actions-buttons">
        <button class="btn btn-select btn-small" id="selectAllBtn">
          <i class="fas fa-check-square"></i> å…¨é€‰
        </button>
        <button class="btn btn-secondary btn-small" id="invertSelectionBtn">
          <i class="fas fa-exchange-alt"></i> åé€‰
        </button>
        <button class="btn btn-select btn-small" id="openSelectedBtn">
          <i class="fas fa-external-link-alt"></i> è®¿é—®é€‰ä¸­é“¾æ¥
        </button>
        <button class="btn btn-warning btn-small" id="moveSelectedBtn">
          <i class="fas fa-folder-open"></i> ç§»åŠ¨åˆ°
        </button>
        <button class="btn btn-secondary btn-small" id="clearSelectionBtn">
          <i class="fas fa-times"></i> æ¸…ç©ºé€‰æ‹©
        </button>
      </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="content-grid" id="contentGrid">
      <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    </div>

    <!-- é“¾æ¥åˆ—è¡¨åŒºåŸŸ -->
    <div class="links-container" id="linksContainer">
      <div class="links-header">
        <h2 id="currentFolderTitle">
          <i class="fas fa-folder" id="currentFolderIcon"></i>
          <span id="currentFolderName">æ–‡ä»¶å¤¹åç§°</span>
        </h2>
        <div class="links-header-actions">
          <button class="btn btn-secondary" id="addLinkToCurrentBtn">
            <i class="fas fa-plus"></i>
            <span class="desktop-only">æ·»åŠ é“¾æ¥</span>
          </button>
          <button class="btn" id="addSubfolderBtn">
            <i class="fas fa-folder-plus"></i>
            <span class="desktop-only">å­æ–‡ä»¶å¤¹</span>
          </button>
          <button class="btn btn-select" id="bulkSelectBtn">
            <i class="fas fa-check-circle"></i>
            <span class="desktop-only">æ‰¹é‡é€‰æ‹©</span>
          </button>
        </div>
      </div>
      
      <!-- é€‰æ‹©æ¨¡å¼æç¤º -->
      <div class="selection-mode-hint" id="selectionModeHint" style="display: none;">
        <i class="fas fa-mouse-pointer"></i> ç‚¹å‡»é“¾æ¥å³ä¸Šè§’çš„å¤é€‰æ¡†é€‰æ‹©/å–æ¶ˆé€‰æ‹©é“¾æ¥
      </div>
      
      <div class="links-list" id="linksList">
        <!-- é“¾æ¥å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
      </div>
    </div>

    <!-- è¿”å›æŒ‰é’® -->
    <button class="back-btn" id="backBtn" style="display: none;">
      <i class="fas fa-arrow-left"></i> è¿”å›ä¸Šçº§
    </button>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <div class="stats-footer" id="statsFooter">
      <div class="stat-item">
        <div class="stat-value" id="folderCount">0</div>
        <div class="stat-label">æ–‡ä»¶å¤¹</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="linkCount">0</div>
        <div class="stat-label">é“¾æ¥</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="subfolderCount">0</div>
        <div class="stat-label">å­æ–‡ä»¶å¤¹</div>
      </div>
    </div>

    <!-- åŒæ­¥çŠ¶æ€ -->
    <div class="sync-status" id="syncStatus" style="display: none;">
      <i class="fas fa-sync-alt fa-spin"></i>
      <span id="syncStatusText">æ­£åœ¨åŒæ­¥...</span>
    </div>

    <!-- é¡µè„š -->
    <footer class="footer">
      <p>ä¸ªäººå¯¼èˆªé¡µ &copy; 2024 | æ•°æ®å­˜å‚¨äºæ‚¨çš„æµè§ˆå™¨å’ŒGitHub Gist</p>
      <p style="margin-top: 10px; font-size: 13px;">
        æœ€ååŒæ­¥æ—¶é—´: <span id="lastSyncTime">ä»æœªåŒæ­¥</span>
        <button class="btn btn-small" id="manualSyncBtn" style="margin-left: 10px; padding: 4px 10px;">
          <i class="fas fa-sync-alt"></i> æ‰‹åŠ¨åŒæ­¥
        </button>
      </p>
    </footer>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šæ·»åŠ /ç¼–è¾‘æ–‡ä»¶å¤¹ -->
  <div class="modal" id="folderModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="folderModalTitle">æ–°å»ºæ–‡ä»¶å¤¹</h3>
        <button class="modal-close" id="folderModalClose">&times;</button>
      </div>
      <form id="folderForm">
        <div class="form-group">
          <label class="form-label" for="folderName">æ–‡ä»¶å¤¹åç§° *</label>
          <input type="text" class="form-input" id="folderName" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="folderDescription">æè¿° (å¯é€‰)</label>
          <input type="text" class="form-input" id="folderDescription" placeholder="ä¾‹å¦‚ï¼šå·¥ä½œç›¸å…³çš„é“¾æ¥">
        </div>
        <div class="form-group">
          <label class="form-label" for="parentFolder">çˆ¶æ–‡ä»¶å¤¹</label>
          <select class="form-input" id="parentFolder">
            <option value="">æ—  (æ ¹ç›®å½•)</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="folderCancelBtn">å–æ¶ˆ</button>
          <button type="submit" class="btn" id="folderSubmitBtn">ä¿å­˜</button>
        </div>
      </form>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šæ·»åŠ /ç¼–è¾‘é“¾æ¥ -->
  <div class="modal" id="linkModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="linkModalTitle">æ·»åŠ é“¾æ¥</h3>
        <button class="modal-close" id="linkModalClose">&times;</button>
      </div>
      <form id="linkForm">
        <div class="form-group">
          <label class="form-label" for="linkName">é“¾æ¥åç§° *</label>
          <input type="text" class="form-input" id="linkName" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="linkUrl">URL *</label>
          <input type="url" class="form-input" id="linkUrl" placeholder="https://example.com" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="linkFolder">æ‰€å±æ–‡ä»¶å¤¹</label>
          <select class="form-input" id="linkFolder">
            <option value="">æ—  (æ˜¾ç¤ºåœ¨æ ¹ç›®å½•)</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label" for="linkNotes">å¤‡æ³¨ (å¯é€‰)</label>
          <textarea class="form-textarea" id="linkNotes" placeholder="è¿™ä¸ªç½‘ç«™çš„ä¸»è¦åŠŸèƒ½ã€ç”¨é€”ã€æ³¨æ„äº‹é¡¹ç­‰..."></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="linkCancelBtn">å–æ¶ˆ</button>
          <button type="submit" class="btn" id="linkSubmitBtn">ä¿å­˜</button>
        </div>
      </form>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šç§»åŠ¨é“¾æ¥ -->
  <div class="modal" id="moveLinksModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">ç§»åŠ¨é“¾æ¥</h3>
        <button class="modal-close" id="moveLinksModalClose">&times;</button>
      </div>
      <div class="move-links-info" id="moveLinksInfo">
        å°†ç§»åŠ¨ <span id="moveLinksCount">0</span> ä¸ªé€‰ä¸­çš„é“¾æ¥
      </div>
      <div class="form-group">
        <label class="form-label" for="moveTargetFolder">é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹</label>
        <select class="form-input" id="moveTargetFolder">
          <option value="">æ ¹ç›®å½•</option>
        </select>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" id="moveLinksCancelBtn">å–æ¶ˆ</button>
        <button type="button" class="btn btn-warning" id="moveLinksConfirmBtn">ç§»åŠ¨</button>
      </div>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šæ‰“å¼€é“¾æ¥ç¡®è®¤ -->
  <div class="modal" id="openLinksModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">æ‰“å¼€é€‰ä¸­çš„é“¾æ¥</h3>
        <button class="modal-close" id="openLinksModalClose">&times;</button>
      </div>
      <div class="move-links-info">
        å°†æ‰“å¼€ <span id="openLinksCount">0</span> ä¸ªé€‰ä¸­çš„é“¾æ¥
      </div>
      <div class="open-links-list" id="openLinksList">
        <!-- é“¾æ¥åˆ—è¡¨å°†åŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" id="openLinksCancelBtn">å–æ¶ˆ</button>
        <button type="button" class="btn btn-select" id="openLinksConfirmBtn">æ‰“å¼€æ‰€æœ‰é“¾æ¥</button>
      </div>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šè®¾ç½® -->
  <div class="modal" id="settingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">è®¾ç½®</h3>
        <button class="modal-close" id="settingsModalClose">&times;</button>
      </div>
      <div style="margin-bottom: 30px;">
        <h4 style="margin-bottom: 15px; font-size: 18px;">GitHubåŒæ­¥</h4>
        <div class="form-group">
          <label class="form-label" for="githubToken">GitHubä¸ªäººè®¿é—®ä»¤ç‰Œ</label>
          <div style="display: flex; gap: 10px;">
            <input type="password" class="form-input" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"
              style="flex: 1;">
            <button type="button" class="btn btn-secondary" id="toggleTokenVisibility">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <p style="font-size: 13px; color: var(--text-secondary); margin-top: 8px;">
            éœ€è¦ <strong>gist</strong> æƒé™ã€‚å·²é…ç½®: <span id="tokenStatus">æœªé…ç½®</span>
          </p>
        </div>
        <div class="form-group">
          <label class="form-label" for="gistId">Gist ID</label>
          <input type="text" class="form-input" id="gistId" placeholder="ç•™ç©ºå°†è‡ªåŠ¨åˆ›å»º">
          <p style="font-size: 13px; color: var(--text-secondary); margin-top: 8px;">
            å½“å‰Gist ID: <span id="currentGistId">æœªè®¾ç½®</span>
          </p>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn" id="saveSettingsBtn" style="flex: 1;">
            <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
          </button>
          <button class="btn btn-secondary" id="testSyncBtn" style="flex: 1;">
            <i class="fas fa-sync-alt"></i> æµ‹è¯•åŒæ­¥
          </button>
        </div>
      </div>
      <div style="margin-bottom: 30px;">
        <h4 style="margin-bottom: 15px; font-size: 18px;">æ•°æ®ç®¡ç†</h4>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn btn-secondary" id="exportDataBtn" style="flex: 1;">
            <i class="fas fa-download"></i> å¯¼å‡ºJSON
          </button>
          <button class="btn btn-secondary" id="importDataBtn" style="flex: 1;">
            <i class="fas fa-upload"></i> å¯¼å…¥æ•°æ®
          </button>
        </div>
        <input type="file" id="importFileInput" accept=".json" style="display: none;">
        <div style="margin-top: 15px;">
          <button class="btn btn-danger" id="clearDataBtn" style="width: 100%;">
            <i class="fas fa-trash"></i> æ¸…ç©ºæ‰€æœ‰æ•°æ®
          </button>
        </div>
      </div>
      <div>
        <h4 style="margin-bottom: 15px; font-size: 18px;">å…³äº</h4>
        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
          ä¸ªäººå¯¼èˆªé¡µ v2.2 | æ”¯æŒæ–‡ä»¶å¤¹åµŒå¥—ã€é“¾æ¥å¤‡æ³¨ã€æ‰¹é‡é€‰æ‹©ã€ç§»åŠ¨é“¾æ¥ã€ç§»åŠ¨ç«¯ä¼˜åŒ–
        </p>
      </div>
    </div>
  </div>

  <!-- ç¡®è®¤æ¨¡æ€æ¡† -->
  <div class="modal confirm-modal" id="confirmModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="confirmTitle">ç¡®è®¤æ“ä½œ</h3>
        <button class="modal-close" id="confirmModalClose">&times;</button>
      </div>
      <div class="confirm-text" id="confirmText">
        æ‚¨ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ
      </div>
      <div class="confirm-actions">
        <button class="btn btn-secondary" id="confirmCancelBtn">å–æ¶ˆ</button>
        <button class="btn" id="confirmActionBtn">ç¡®è®¤</button>
      </div>
    </div>
  </div>

  <!-- é€šçŸ¥æ¶ˆæ¯ -->
  <div class="notification" id="notification"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // åº”ç”¨çŠ¶æ€
      const appState = {
        folders: [],
        links: [],
        editingFolderId: null,
        editingLinkId: null,
        currentFolderId: '',
        githubToken: localStorage.getItem('githubToken') || '',
        gistId: localStorage.getItem('gistId') || '',
        lastSync: localStorage.getItem('lastSync') || null,
        theme: localStorage.getItem('theme') || 'light',
        selectedLinks: new Set(), // å­˜å‚¨é€‰ä¸­çš„é“¾æ¥ID
        bulkSelectMode: false // æ‰¹é‡é€‰æ‹©æ¨¡å¼
      };

      // DOMå…ƒç´ 
      const contentGrid = document.getElementById('contentGrid');
      const breadcrumb = document.getElementById('breadcrumb');
      const linksContainer = document.getElementById('linksContainer');
      const linksList = document.getElementById('linksList');
      const currentFolderName = document.getElementById('currentFolderName');
      const currentFolderIcon = document.getElementById('currentFolderIcon');
      const backBtn = document.getElementById('backBtn');
      const searchInput = document.getElementById('searchInput');
      const syncStatus = document.getElementById('syncStatus');
      const syncStatusText = document.getElementById('syncStatusText');
      const notification = document.getElementById('notification');
      const lastSyncTime = document.getElementById('lastSyncTime');
      const folderCount = document.getElementById('folderCount');
      const linkCount = document.getElementById('linkCount');
      const subfolderCount = document.getElementById('subfolderCount');
      const quickActions = document.getElementById('quickActions');
      const selectionModeHint = document.getElementById('selectionModeHint');

      // æ‰¹é‡é€‰æ‹©ç›¸å…³DOMå…ƒç´ 
      const bulkActionsBar = document.getElementById('bulkActionsBar');
      const selectedCount = document.getElementById('selectedCount');
      const selectAllBtn = document.getElementById('selectAllBtn');
      const invertSelectionBtn = document.getElementById('invertSelectionBtn');
      const openSelectedBtn = document.getElementById('openSelectedBtn');
      const clearSelectionBtn = document.getElementById('clearSelectionBtn');
      const bulkSelectBtn = document.getElementById('bulkSelectBtn');
      const moveSelectedBtn = document.getElementById('moveSelectedBtn');

      // åˆå§‹åŒ–åº”ç”¨
      initApp();

      function initApp() {
        // è®¾ç½®ä¸»é¢˜
        setTheme(appState.theme);

        // åŠ è½½æ•°æ®ï¼ˆæ²¡æœ‰ç¤ºä¾‹æ•°æ®ï¼‰
        loadData();

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        updateStats();

        // æ›´æ–°æœ€ååŒæ­¥æ—¶é—´æ˜¾ç¤º
        updateLastSyncDisplay();

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        setupEventListeners();

        // æ¸²æŸ“å†…å®¹
        renderCurrentView();

        // å¦‚æœæœ‰GitHubä»¤ç‰Œï¼Œå°è¯•ä»GiståŒæ­¥
        if (appState.githubToken && appState.gistId) {
          setTimeout(() => syncWithGist('pull'), 1000);
        }
      }

      function loadData() {
        const savedFolders = localStorage.getItem('navFolders');
        const savedLinks = localStorage.getItem('navLinks');

        if (savedFolders) {
          try {
            appState.folders = JSON.parse(savedFolders);
          } catch (e) {
            console.error('è§£ææ–‡ä»¶å¤¹æ•°æ®å¤±è´¥:', e);
            appState.folders = [];
          }
        }

        if (savedLinks) {
          try {
            appState.links = JSON.parse(savedLinks);
          } catch (e) {
            console.error('è§£æé“¾æ¥æ•°æ®å¤±è´¥:', e);
            appState.links = [];
          }
        }

        // æ²¡æœ‰ç¤ºä¾‹æ•°æ®ï¼Œå®Œå…¨ç©ºç™½çš„åˆå§‹çŠ¶æ€

        // ä¿å­˜åˆå§‹æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
        saveDataToLocalStorage();
      }

      function saveDataToLocalStorage() {
        localStorage.setItem('navFolders', JSON.stringify(appState.folders));
        localStorage.setItem('navLinks', JSON.stringify(appState.links));
      }

      function saveData() {
        saveDataToLocalStorage();

        // è‡ªåŠ¨åŒæ­¥åˆ°GitHub
        if (appState.githubToken) {
          syncWithGist('push');
        } else {
          showNotification('æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°', 'success');
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        updateStats();
      }

      function updateStats() {
        const totalFolders = appState.folders.length;
        const totalLinks = appState.links.length;
        const subfolders = appState.folders.filter(f => f.parentId !== '').length;

        folderCount.textContent = totalFolders;
        linkCount.textContent = totalLinks;
        subfolderCount.textContent = subfolders;
      }

      // ===================== æ‰¹é‡é€‰æ‹©åŠŸèƒ½ =====================
      // åˆ‡æ¢æ‰¹é‡é€‰æ‹©æ¨¡å¼
      function toggleBulkSelectMode() {
        appState.bulkSelectMode = !appState.bulkSelectMode;

        if (appState.bulkSelectMode) {
          // è¿›å…¥æ‰¹é‡é€‰æ‹©æ¨¡å¼
          bulkSelectBtn.innerHTML = '<i class="fas fa-times"></i><span class="desktop-only">å–æ¶ˆé€‰æ‹©</span>';
          bulkSelectBtn.style.background = 'var(--danger-color)';
          bulkActionsBar.classList.add('active');
          selectionModeHint.style.display = 'block';
          showNotification('å·²è¿›å…¥æ‰¹é‡é€‰æ‹©æ¨¡å¼ï¼Œç‚¹å‡»é“¾æ¥å³ä¸Šè§’çš„å¤é€‰æ¡†é€‰æ‹©é“¾æ¥', 'success');
        } else {
          // é€€å‡ºæ‰¹é‡é€‰æ‹©æ¨¡å¼
          bulkSelectBtn.innerHTML = '<i class="fas fa-check-circle"></i><span class="desktop-only">æ‰¹é‡é€‰æ‹©</span>';
          bulkSelectBtn.style.background = 'var(--select-color)';
          bulkActionsBar.classList.remove('active');
          selectionModeHint.style.display = 'none';
          clearSelection();
          showNotification('å·²é€€å‡ºæ‰¹é‡é€‰æ‹©æ¨¡å¼', 'info');
        }

        // é‡æ–°æ¸²æŸ“å½“å‰è§†å›¾ä»¥æ˜¾ç¤º/éšè—å¤é€‰æ¡†
        renderCurrentView();
      }

      // é€‰æ‹©/å–æ¶ˆé€‰æ‹©é“¾æ¥
      function toggleLinkSelection(linkId) {
        if (appState.selectedLinks.has(linkId)) {
          appState.selectedLinks.delete(linkId);
        } else {
          appState.selectedLinks.add(linkId);
        }
        updateSelectionDisplay();

        // æ›´æ–°é“¾æ¥å¡ç‰‡çš„é€‰ä¸­çŠ¶æ€
        const linkCard = document.querySelector(`.link-card[data-id="${linkId}"]`);
        if (linkCard) {
          const checkbox = linkCard.querySelector('.link-checkbox');
          if (checkbox) {
            checkbox.checked = appState.selectedLinks.has(linkId);
            if (appState.selectedLinks.has(linkId)) {
              linkCard.classList.add('selected');
            } else {
              linkCard.classList.remove('selected');
            }
          }
        }
      }

      // å…¨é€‰å½“å‰æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰é“¾æ¥
      function selectAllLinks() {
        const currentFolderId = appState.currentFolderId;
        const currentLinks = appState.links.filter(link => link.folderId === currentFolderId);

        if (currentLinks.length === 0) {
          showNotification('å½“å‰æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰é“¾æ¥', 'warning');
          return;
        }

        currentLinks.forEach(link => {
          appState.selectedLinks.add(link.id);
        });

        updateSelectionDisplay();
        updateLinkCardsSelection();
        showNotification(`å·²é€‰æ‹©å…¨éƒ¨ ${currentLinks.length} ä¸ªé“¾æ¥`, 'success');
      }

      // åé€‰å½“å‰æ–‡ä»¶å¤¹ä¸­çš„é“¾æ¥
      function invertSelection() {
        const currentFolderId = appState.currentFolderId;
        const currentLinks = appState.links.filter(link => link.folderId === currentFolderId);

        if (currentLinks.length === 0) {
          showNotification('å½“å‰æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰é“¾æ¥', 'warning');
          return;
        }

        currentLinks.forEach(link => {
          if (appState.selectedLinks.has(link.id)) {
            appState.selectedLinks.delete(link.id);
          } else {
            appState.selectedLinks.add(link.id);
          }
        });

        updateSelectionDisplay();
        updateLinkCardsSelection();
        showNotification('å·²åé€‰é“¾æ¥', 'success');
      }

      // æ¸…ç©ºé€‰æ‹©
      function clearSelection() {
        appState.selectedLinks.clear();
        updateSelectionDisplay();
        updateLinkCardsSelection();
      }

      // æ‰“å¼€é€‰ä¸­çš„é“¾æ¥ - ä¿®å¤ç‰ˆæœ¬ï¼šæ˜¾ç¤ºç¡®è®¤æ¨¡æ€æ¡†
      function openSelectedLinks() {
        if (appState.selectedLinks.size === 0) {
          showNotification('è¯·å…ˆé€‰æ‹©è¦è®¿é—®çš„é“¾æ¥', 'warning');
          return;
        }

        // æ˜¾ç¤ºæ‰“å¼€é“¾æ¥ç¡®è®¤æ¨¡æ€æ¡†
        const modal = document.getElementById('openLinksModal');
        const openLinksList = document.getElementById('openLinksList');
        const openLinksCount = document.getElementById('openLinksCount');

        // æ›´æ–°è®¡æ•°
        openLinksCount.textContent = appState.selectedLinks.size;

        // æ¸…ç©ºåˆ—è¡¨
        openLinksList.innerHTML = '';

        // è·å–é€‰ä¸­çš„é“¾æ¥
        const selectedLinks = Array.from(appState.selectedLinks);

        // ç”Ÿæˆé“¾æ¥åˆ—è¡¨
        selectedLinks.forEach(linkId => {
          const link = appState.links.find(l => l.id === linkId);
          if (link) {
            const listItem = document.createElement('div');
            listItem.className = 'open-links-item';
            
            // è·å–é“¾æ¥å›¾æ ‡
            let iconHtml = '<i class="fas fa-link"></i>';
            if (link.icon) {
              iconHtml = `<img src="${link.icon}" alt="${link.name}" class="open-links-item-icon">`;
            } else if (link.url) {
              try {
                const domain = new URL(link.url).hostname;
                const faviconUrl = `https://www.google.com/s2/favicons?domain=${domain}&sz=32`;
                iconHtml = `<img src="${faviconUrl}" alt="${link.name}" class="open-links-item-icon">`;
              } catch (e) {
                // ä½¿ç”¨é»˜è®¤å›¾æ ‡
              }
            }
            
            listItem.innerHTML = `
              <div class="open-links-item-icon">${iconHtml}</div>
              <div class="open-links-item-text">
                <div class="open-links-item-name">${link.name}</div>
                <div class="open-links-item-url">${link.url}</div>
              </div>
            `;
            openLinksList.appendChild(listItem);
          }
        });

        modal.classList.add('active');
      }

      // å®é™…æ‰§è¡Œæ‰“å¼€é“¾æ¥æ“ä½œ
      function executeOpenLinks() {
        const selectedLinks = Array.from(appState.selectedLinks);
        let openedCount = 0;
        let failedCount = 0;

        // ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•ï¼šå…ˆæ‰“å¼€ç¬¬ä¸€ä¸ªé“¾æ¥ï¼Œç„¶ååœ¨æ¯ä¸ªæ–°æ ‡ç­¾é¡µä¸­ç»§ç»­æ‰“å¼€ä¸‹ä¸€ä¸ªé“¾æ¥
        function openNextLink(index) {
          if (index >= selectedLinks.length) {
            // æ‰€æœ‰é“¾æ¥éƒ½å·²å°è¯•æ‰“å¼€
            setTimeout(() => {
              let message = `å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ ${openedCount} ä¸ªé“¾æ¥`;
              if (failedCount > 0) {
                message += `ï¼Œ${failedCount} ä¸ªé“¾æ¥æ‰“å¼€å¤±è´¥`;
              }
              showNotification(message, openedCount > 0 ? 'success' : 'warning');
              
              // æ¸…ç©ºé€‰æ‹©
              clearSelection();
            }, 500);
            return;
          }

          const linkId = selectedLinks[index];
          const link = appState.links.find(l => l.id === linkId);
          
          if (link && link.url) {
            try {
              // ä½¿ç”¨formæäº¤çš„æ–¹å¼æ‰“å¼€é“¾æ¥ï¼Œè¿™ç§æ–¹æ³•æ›´å¯é 
              const form = document.createElement('form');
              form.action = link.url;
              form.target = '_blank';
              form.method = 'GET';
              form.style.display = 'none';
              document.body.appendChild(form);
              form.submit();
              document.body.removeChild(form);
              
              openedCount++;
            } catch (e) {
              console.error('æ— æ³•æ‰“å¼€é“¾æ¥:', link.url, e);
              failedCount++;
            }
          } else {
            failedCount++;
          }

          // ç»§ç»­æ‰“å¼€ä¸‹ä¸€ä¸ªé“¾æ¥ï¼Œæœ‰è¾ƒé•¿çš„å»¶æ—¶è®©æµè§ˆå™¨æœ‰æ—¶é—´å¤„ç†
          setTimeout(() => openNextLink(index + 1), 500);
        }

        // å¼€å§‹æ‰“å¼€é“¾æ¥
        openNextLink(0);
        
        // å…³é—­æ¨¡æ€æ¡†
        document.getElementById('openLinksModal').classList.remove('active');
      }

      // ç§»åŠ¨é€‰ä¸­çš„é“¾æ¥åˆ°å…¶ä»–æ–‡ä»¶å¤¹
      function moveSelectedLinks() {
        if (appState.selectedLinks.size === 0) {
          showNotification('è¯·å…ˆé€‰æ‹©è¦ç§»åŠ¨çš„é“¾æ¥', 'warning');
          return;
        }

        // æ˜¾ç¤ºç§»åŠ¨é“¾æ¥æ¨¡æ€æ¡†
        const modal = document.getElementById('moveLinksModal');
        const info = document.getElementById('moveLinksInfo');
        const targetFolderSelect = document.getElementById('moveTargetFolder');

        // æ›´æ–°ä¿¡æ¯
        document.getElementById('moveLinksCount').textContent = appState.selectedLinks.size;

        // å¡«å……æ–‡ä»¶å¤¹é€‰æ‹©åˆ—è¡¨
        targetFolderSelect.innerHTML = '<option value="">æ ¹ç›®å½•</option>';

        // æ’é™¤å½“å‰æ–‡ä»¶å¤¹ï¼Œé¿å…æ— æ„ä¹‰çš„ç§»åŠ¨
        const currentFolderId = appState.currentFolderId;
        appState.folders.forEach(folder => {
          // å¦‚æœæ˜¯å½“å‰æ–‡ä»¶å¤¹ï¼Œè·³è¿‡
          if (folder.id === currentFolderId) return;

          const option = document.createElement('option');
          option.value = folder.id;
          option.textContent = folder.name;
          targetFolderSelect.appendChild(option);
        });

        modal.classList.add('active');
      }

      // æ‰§è¡Œç§»åŠ¨é“¾æ¥æ“ä½œ
      function executeMoveLinks(targetFolderId) {
        if (appState.selectedLinks.size === 0) return;

        const selectedLinks = Array.from(appState.selectedLinks);
        let movedCount = 0;

        selectedLinks.forEach(linkId => {
          const link = appState.links.find(l => l.id === linkId);
          if (link) {
            // æ›´æ–°é“¾æ¥çš„æ–‡ä»¶å¤¹ID
            link.folderId = targetFolderId;
            link.updatedAt = Date.now();
            movedCount++;
          }
        });

        // ä¿å­˜æ•°æ®
        saveData();
        // é‡æ–°æ¸²æŸ“å½“å‰è§†å›¾
        renderCurrentView();
        // æ¸…ç©ºé€‰æ‹©
        clearSelection();
        // å…³é—­æ¨¡æ€æ¡†
        document.getElementById('moveLinksModal').classList.remove('active');

        showNotification(`å·²å°† ${movedCount} ä¸ªé“¾æ¥ç§»åŠ¨åˆ°æ–°æ–‡ä»¶å¤¹`, 'success');
      }

      // æ›´æ–°é€‰æ‹©æ˜¾ç¤º
      function updateSelectionDisplay() {
        selectedCount.textContent = `å·²é€‰æ‹© ${appState.selectedLinks.size} ä¸ªé“¾æ¥`;

        // å¦‚æœå½“å‰æ˜¯æ‰¹é‡é€‰æ‹©æ¨¡å¼ä½†æ²¡æœ‰é€‰ä¸­ä»»ä½•é“¾æ¥ï¼Œæ˜¾ç¤ºæç¤º
        if (appState.bulkSelectMode && appState.selectedLinks.size === 0) {
          selectedCount.textContent = 'è¯·ç‚¹å‡»é“¾æ¥å³ä¸Šè§’çš„å¤é€‰æ¡†é€‰æ‹©é“¾æ¥';
        }
      }

      // æ›´æ–°é“¾æ¥å¡ç‰‡çš„é€‰ä¸­çŠ¶æ€æ˜¾ç¤º
      function updateLinkCardsSelection() {
        document.querySelectorAll('.link-card').forEach(linkCard => {
          const linkId = linkCard.dataset.id;
          const checkbox = linkCard.querySelector('.link-checkbox');
          if (checkbox) {
            checkbox.checked = appState.selectedLinks.has(linkId);
            if (appState.selectedLinks.has(linkId)) {
              linkCard.classList.add('selected');
            } else {
              linkCard.classList.remove('selected');
            }
          }
        });
      }

      // ===================== å…¶ä»–åŠŸèƒ½ =====================
      async function syncWithGist(action) {
        if (!appState.githubToken) {
          if (action === 'pull') return;
          showNotification('è¯·å…ˆé…ç½®GitHubä»¤ç‰Œ', 'warning');
          return;
        }

        syncStatusText.textContent = action === 'push' ? 'æ­£åœ¨æ¨é€æ•°æ®...' : 'æ­£åœ¨æ‹‰å–æ•°æ®...';
        syncStatus.style.display = 'flex';

        try {
          const data = {
            folders: appState.folders,
            links: appState.links,
            updatedAt: new Date().toISOString(),
            appVersion: '2.2'
          };

          if (action === 'push') {
            if (appState.gistId) {
              await updateGist(appState.gistId, data);
              appState.lastSync = new Date().toISOString();
              localStorage.setItem('lastSync', appState.lastSync);
              updateLastSyncDisplay();
              showNotification('æ•°æ®å·²åŒæ­¥åˆ°GitHub', 'success');
            } else {
              // å¦‚æœæ²¡æœ‰Gist IDï¼Œå…ˆåˆ›å»ºGist
              const gistId = await createGist(data);
              if (gistId) {
                appState.gistId = gistId;
                localStorage.setItem('gistId', gistId);
                appState.lastSync = new Date().toISOString();
                localStorage.setItem('lastSync', appState.lastSync);
                updateLastSyncDisplay();
                showNotification('Giståˆ›å»ºæˆåŠŸï¼Œæ•°æ®å·²åŒæ­¥', 'success');
              }
            }
          } else if (action === 'pull') {
            if (appState.gistId) {
              const remoteData = await fetchGist(appState.gistId);
              if (remoteData) {
                // åˆå¹¶æ•°æ®ï¼šä½¿ç”¨è¿œç¨‹æ•°æ®
                appState.folders = remoteData.folders || [];
                appState.links = remoteData.links || [];
                appState.lastSync = remoteData.updatedAt;
                localStorage.setItem('lastSync', appState.lastSync);

                // ä¿å­˜åˆ°æœ¬åœ°
                saveDataToLocalStorage();

                // æ›´æ–°UI
                updateStats();
                renderCurrentView();
                updateLastSyncDisplay();

                showNotification('å·²ä»GitHubåŒæ­¥æ•°æ®', 'success');
              }
            }
          }
        } catch (error) {
          console.error('åŒæ­¥å¤±è´¥:', error);
          showNotification(`${action === 'push' ? 'æ¨é€' : 'æ‹‰å–'}å¤±è´¥: ${error.message}`, 'error');
        } finally {
          setTimeout(() => {
            syncStatus.style.display = 'none';
          }, 1000);
        }
      }

      async function createGist(data) {
        try {
          const response = await fetch('https://api.github.com/gists', {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${appState.githubToken}`,
              'Content-Type': 'application/json',
              'Accept': 'application/vnd.github.v3+json',
              'User-Agent': 'Personal-Navigation-App'
            },
            body: JSON.stringify({
              description: 'ä¸ªäººå¯¼èˆªæ•°æ®',
              public: false,
              files: {
                'navigation.json': {
                  content: JSON.stringify(data, null, 2)
                }
              }
            })
          });

          if (!response.ok) {
            throw new Error(`åˆ›å»ºGistå¤±è´¥: ${response.status}`);
          }

          const result = await response.json();
          return result.id;
        } catch (error) {
          throw error;
        }
      }

      async function updateGist(gistId, data) {
        try {
          const response = await fetch(`https://api.github.com/gists/${gistId}`, {
            method: 'PATCH',
            headers: {
              'Authorization': `Bearer ${appState.githubToken}`,
              'Content-Type': 'application/json',
              'Accept': 'application/vnd.github.v3+json',
              'User-Agent': 'Personal-Navigation-App'
            },
            body: JSON.stringify({
              description: 'ä¸ªäººå¯¼èˆªæ•°æ®',
              files: {
                'navigation.json': {
                  content: JSON.stringify(data, null, 2)
                }
              }
            })
          });

          if (!response.ok) {
            throw new Error(`æ›´æ–°Gistå¤±è´¥: ${response.status}`);
          }
        } catch (error) {
          throw error;
        }
      }

      async function fetchGist(gistId) {
        try {
          const response = await fetch(`https://api.github.com/gists/${gistId}`, {
            headers: {
              'Authorization': `Bearer ${appState.githubToken}`,
              'Accept': 'application/vnd.github.v3+json',
              'User-Agent': 'Personal-Navigation-App'
            }
          });

          if (!response.ok) {
            throw new Error(`è·å–Gistå¤±è´¥: ${response.status}`);
          }

          const result = await response.json();
          const content = result.files['navigation.json'].content;
          return JSON.parse(content);
        } catch (error) {
          throw error;
        }
      }

      function renderCurrentView() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        const isSearching = searchTerm !== '';

        // æ¸…ç©ºå†…å®¹
        contentGrid.innerHTML = '';
        quickActions.innerHTML = '';

        if (isSearching) {
          // æœç´¢æ¨¡å¼
          renderSearchResults(searchTerm);
        } else if (appState.currentFolderId === '') {
          // æ ¹ç›®å½•è§†å›¾
          renderFolderView('');
          backBtn.style.display = 'none';
        } else {
          // æ–‡ä»¶å¤¹è¯¦æƒ…è§†å›¾
          renderFolderDetails(appState.currentFolderId);
          backBtn.style.display = 'block';
        }

        // æ›´æ–°é€‰æ‹©æ˜¾ç¤º
        updateSelectionDisplay();
      }

      function renderFolderView(parentId) {
        // è·å–å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„å­æ–‡ä»¶å¤¹
        const subfolders = appState.folders
          .filter(folder => folder.parentId === parentId)
          .sort((a, b) => (a.order || 0) - (b.order || 0));

        // æ˜¾ç¤º/éšè—å†…å®¹åŒºåŸŸ
        if (parentId === '') {
          contentGrid.style.display = 'grid';
          linksContainer.style.display = 'none';
          bulkActionsBar.classList.remove('active');
          selectionModeHint.style.display = 'none';
        } else {
          contentGrid.style.display = 'none';
          linksContainer.style.display = 'block';
        }

        // å¦‚æœæ²¡æœ‰å­æ–‡ä»¶å¤¹ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€
        if (subfolders.length === 0 && parentId === '') {
          contentGrid.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-compass"></i>
              <h3>æ‚¨çš„å¯¼èˆªé¡µæ˜¯ç©ºçš„</h3>
              <p>å¼€å§‹æ·»åŠ ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹æˆ–é“¾æ¥å§ï¼</p>
              <div style="margin-top: 20px;">
                <button class="btn" id="firstFolderBtn">
                  <i class="fas fa-folder-plus"></i> åˆ›å»ºç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹
                </button>
                <button class="btn" id="firstLinkBtn" style="margin-left: 10px;">
                  <i class="fas fa-plus"></i> æ·»åŠ ç¬¬ä¸€ä¸ªé“¾æ¥
                </button>
              </div>
            </div>
          `;

          // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
          document.getElementById('firstFolderBtn').addEventListener('click', () => {
            openFolderModal('');
          });

          document.getElementById('firstLinkBtn').addEventListener('click', () => {
            openLinkModal('');
          });

          return;
        }

        // æ¸²æŸ“å­æ–‡ä»¶å¤¹
        subfolders.forEach(folder => {
          const folderCard = createFolderCard(folder);
          contentGrid.appendChild(folderCard);
        });

        // å¦‚æœæ˜¯æ ¹ç›®å½•ï¼Œæ˜¾ç¤ºå¿«é€Ÿæ“ä½œ
        if (parentId === '') {
          updateQuickActions();
        }

        // æ›´æ–°é¢åŒ…å±‘å¯¼èˆª
        updateBreadcrumb(parentId);
      }

      function renderFolderDetails(folderId) {
        const folder = appState.folders.find(f => f.id === folderId);
        if (!folder) return;

        // æ›´æ–°æ–‡ä»¶å¤¹è¯¦æƒ…é¡µæ ‡é¢˜
        currentFolderName.textContent = folder.name;
        currentFolderIcon.className = `fas fa-${folder.icon || 'folder'}`;

        // è·å–å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„å­æ–‡ä»¶å¤¹
        const subfolders = appState.folders
          .filter(f => f.parentId === folderId)
          .sort((a, b) => (a.order || 0) - (b.order || 0));

        // è·å–å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„é“¾æ¥
        const folderLinks = appState.links
          .filter(link => link.folderId === folderId)
          .sort((a, b) => (a.order || 0) - (b.order || 0));

        // æ˜¾ç¤ºæ–‡ä»¶å¤¹è¯¦æƒ…é¡µ
        contentGrid.style.display = 'none';
        linksContainer.style.display = 'block';

        // æ¸…ç©ºé“¾æ¥åˆ—è¡¨
        linksList.innerHTML = '';

        // æ¸²æŸ“å­æ–‡ä»¶å¤¹ï¼ˆåœ¨é“¾æ¥åˆ—è¡¨é¡¶éƒ¨ï¼‰
        subfolders.forEach(subfolder => {
          const folderCard = createLinkCard(subfolder, true);
          linksList.appendChild(folderCard);
        });

        // æ¸²æŸ“é“¾æ¥
        if (folderLinks.length === 0 && subfolders.length === 0) {
          linksList.innerHTML = `
            <div class="empty-state" style="grid-column: 1 / -1;">
              <i class="fas fa-folder-open"></i>
              <h3>è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ç©ºçš„</h3>
              <p>æ·»åŠ ä¸€äº›é“¾æ¥æˆ–å­æ–‡ä»¶å¤¹å§ï¼</p>
            </div>
          `;
        } else {
          folderLinks.forEach(link => {
            const linkCard = createLinkCard(link, false);
            linksList.appendChild(linkCard);
          });
        }

        // æ›´æ–°é¢åŒ…å±‘å¯¼èˆª
        updateBreadcrumb(folderId);
      }

      function renderSearchResults(searchTerm) {
        // æœç´¢æ–‡ä»¶å¤¹
        const matchedFolders = appState.folders.filter(folder =>
          folder.name.toLowerCase().includes(searchTerm) ||
          (folder.description && folder.description.toLowerCase().includes(searchTerm))
        );

        // æœç´¢é“¾æ¥
        const matchedLinks = appState.links.filter(link =>
          link.name.toLowerCase().includes(searchTerm) ||
          link.url.toLowerCase().includes(searchTerm) ||
          (link.notes && link.notes.toLowerCase().includes(searchTerm))
        );

        // æ¸…ç©ºå†…å®¹
        contentGrid.innerHTML = '';

        // æ˜¾ç¤ºæœç´¢ç»“æœç»Ÿè®¡
        const resultCount = matchedFolders.length + matchedLinks.length;
        quickActions.innerHTML = `
          <div style="color: var(--text-secondary); font-size: 14px; padding: 10px 0;">
            æ‰¾åˆ° ${resultCount} ä¸ªç»“æœ (${matchedFolders.length} ä¸ªæ–‡ä»¶å¤¹, ${matchedLinks.length} ä¸ªé“¾æ¥)
          </div>
        `;

        // éšè—å…¶ä»–è§†å›¾
        linksContainer.style.display = 'none';
        backBtn.style.display = 'none';
        contentGrid.style.display = 'grid';
        bulkActionsBar.classList.remove('active');
        selectionModeHint.style.display = 'none';

        if (resultCount === 0) {
          contentGrid.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-search"></i>
              <h3>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç»“æœ</h3>
              <p>å°è¯•ä½¿ç”¨ä¸åŒçš„å…³é”®è¯æœç´¢</p>
            </div>
          `;
          return;
        }

        // æ¸²æŸ“åŒ¹é…çš„æ–‡ä»¶å¤¹
        matchedFolders.forEach(folder => {
          const folderCard = createFolderCard(folder);
          contentGrid.appendChild(folderCard);
        });

        // æ¸²æŸ“åŒ¹é…çš„é“¾æ¥ï¼ˆä»¥å¡ç‰‡å½¢å¼æ˜¾ç¤ºï¼‰
        matchedLinks.forEach(link => {
          const linkCard = createLinkCard(link, false);
          contentGrid.appendChild(linkCard);
        });
      }

      function createFolderCard(folder) {
        const folderCard = document.createElement('div');
        folderCard.className = 'folder-card';
        folderCard.dataset.id = folder.id;

        // è·å–å­æ–‡ä»¶å¤¹å’Œé“¾æ¥æ•°é‡
        const subfolderCount = appState.folders.filter(f => f.parentId === folder.id).length;
        const linkCount = appState.links.filter(link => link.folderId === folder.id).length;

        folderCard.innerHTML = `
          <div class="folder-header">
            <div class="folder-info">
              <div class="folder-icon">
                <i class="fas fa-${folder.icon || 'folder'}"></i>
              </div>
              <div class="folder-text">
                <div class="folder-title">${folder.name}</div>
                <div class="folder-desc">${folder.description || ''}</div>
              </div>
            </div>
            <div class="folder-actions">
              <button class="btn btn-small btn-secondary edit-folder-btn" data-id="${folder.id}">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-small btn-danger delete-folder-btn" data-id="${folder.id}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="folder-stats">
            <span>${subfolderCount} ä¸ªå­æ–‡ä»¶å¤¹</span>
            <span>${linkCount} ä¸ªé“¾æ¥</span>
          </div>
        `;

        // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆè¿›å…¥æ–‡ä»¶å¤¹ï¼‰
        folderCard.addEventListener('click', function (e) {
          if (!e.target.closest('.folder-actions')) {
            navigateToFolder(folder.id);
          }
        });

        // æ·»åŠ ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’®äº‹ä»¶
        folderCard.querySelector('.edit-folder-btn').addEventListener('click', function (e) {
          e.stopPropagation();
          openFolderModal(this.dataset.id);
        });

        folderCard.querySelector('.delete-folder-btn').addEventListener('click', function (e) {
          e.stopPropagation();
          deleteFolder(this.dataset.id);
        });

        return folderCard;
      }

      function createLinkCard(item, isFolder = false) {
        const card = document.createElement('div');
        card.className = 'link-card';
        card.dataset.id = item.id;

        if (isFolder) {
          // åˆ›å»ºæ–‡ä»¶å¤¹å¡ç‰‡ï¼ˆåœ¨é“¾æ¥åˆ—è¡¨ä¸­ï¼‰
          const folder = item;
          const subfolderCount = appState.folders.filter(f => f.parentId === folder.id).length;
          const linkCount = appState.links.filter(link => link.folderId === folder.id).length;

          card.innerHTML = `
            <div class="link-header">
              <div class="link-icon-container">
                <i class="fas fa-${folder.icon || 'folder'}"></i>
              </div>
              <div class="link-title-container">
                <div class="link-title">${folder.name}</div>
                <div class="link-url">æ–‡ä»¶å¤¹</div>
                ${folder.description ? `<div class="link-notes" style="margin-top: 8px; font-size: 12px;">${folder.description}</div>` : ''}
              </div>
            </div>
            <div class="link-actions">
              <button class="btn btn-small" data-id="${folder.id}">
                <i class="fas fa-folder-open"></i> æ‰“å¼€
              </button>
              <button class="btn btn-small btn-secondary edit-folder-btn" data-id="${folder.id}">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-small btn-danger delete-folder-btn" data-id="${folder.id}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          `;

          // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
          card.querySelector('button:first-child').addEventListener('click', function (e) {
            e.stopPropagation();
            navigateToFolder(this.dataset.id);
          });

          card.querySelector('.edit-folder-btn').addEventListener('click', function (e) {
            e.stopPropagation();
            openFolderModal(this.dataset.id);
          });

          card.querySelector('.delete-folder-btn').addEventListener('click', function (e) {
            e.stopPropagation();
            deleteFolder(this.dataset.id);
          });

        } else {
          // åˆ›å»ºé“¾æ¥å¡ç‰‡
          const link = item;
          const folder = appState.folders.find(f => f.id === link.folderId);
          const folderName = folder ? folder.name : 'æ ¹ç›®å½•';

          // åªåœ¨æ‰¹é‡é€‰æ‹©æ¨¡å¼ä¸‹æ˜¾ç¤ºå¤é€‰æ¡†
          const showCheckbox = appState.bulkSelectMode;
          const isSelected = appState.selectedLinks.has(link.id);

          card.innerHTML = `
            ${showCheckbox ? `<input type="checkbox" class="link-checkbox" ${isSelected ? 'checked' : ''}>` : ''}
            <div class="link-header">
              <div class="link-icon-container" id="linkIcon-${link.id}">
                <i class="fas fa-link"></i>
              </div>
              <div class="link-title-container">
                <div class="link-title">${link.name}</div>
                <div class="link-url">${link.url}</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">
                  ä½äº: ${folderName}
                </div>
              </div>
            </div>
            ${link.notes ? `<div class="link-notes">${link.notes}</div>` : ''}
            <div class="link-actions">
              <a href="${link.url}" target="_blank" class="btn btn-small" onclick="event.stopPropagation();">
                <i class="fas fa-external-link-alt"></i> è®¿é—®
              </a>
              <button class="btn btn-small btn-secondary edit-link-btn" data-id="${link.id}">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-small btn-danger delete-link-btn" data-id="${link.id}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          `;

          // è®¾ç½®é€‰ä¸­çŠ¶æ€
          if (isSelected) {
            card.classList.add('selected');
          }

          // åŠ è½½é“¾æ¥å›¾æ ‡
          loadLinkIcon(link);

          // æ·»åŠ å¤é€‰æ¡†ç‚¹å‡»äº‹ä»¶
          if (showCheckbox) {
            const checkbox = card.querySelector('.link-checkbox');
            checkbox.addEventListener('click', function (e) {
              e.stopPropagation();
              toggleLinkSelection(link.id);
            });
          }

          // æ·»åŠ ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’®äº‹ä»¶
          card.querySelector('.edit-link-btn').addEventListener('click', function (e) {
            e.stopPropagation();
            editLink(this.dataset.id);
          });

          card.querySelector('.delete-link-btn').addEventListener('click', function (e) {
            e.stopPropagation();
            deleteLink(this.dataset.id);
          });
        }

        return card;
      }

      function loadLinkIcon(link) {
        if (!link.icon && link.url) {
          try {
            const domain = new URL(link.url).hostname;
            const faviconUrl = `https://www.google.com/s2/favicons?domain=${domain}&sz=64`;

            const iconContainer = document.getElementById(`linkIcon-${link.id}`);
            if (iconContainer) {
              const img = new Image();
              img.onload = function () {
                iconContainer.innerHTML = `<img src="${faviconUrl}" alt="${link.name}">`;
              };
              img.onerror = function () {
                // ä¿æŒé»˜è®¤å›¾æ ‡
              };
              img.src = faviconUrl;
            }
          } catch (e) {
            // URLæ— æ•ˆï¼Œå¿½ç•¥
          }
        } else if (link.icon) {
          const iconContainer = document.getElementById(`linkIcon-${link.id}`);
          if (iconContainer) {
            iconContainer.innerHTML = `<img src="${link.icon}" alt="${link.name}">`;
          }
        }
      }

      function updateQuickActions() {
        // è·å–æ ¹ç›®å½•ä¸‹çš„é“¾æ¥æ•°é‡
        const rootLinks = appState.links.filter(link => link.folderId === '').length;

        quickActions.innerHTML = `
          <button class="btn btn-secondary" id="viewRootLinksBtn">
            <i class="fas fa-link"></i> æŸ¥çœ‹æ ¹ç›®å½•é“¾æ¥ (${rootLinks})
          </button>
          <button class="btn btn-secondary" id="viewAllFoldersBtn">
            <i class="fas fa-sitemap"></i> æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶å¤¹
          </button>
        `;

        // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('viewRootLinksBtn').addEventListener('click', function () {
          showRootLinks();
        });

        document.getElementById('viewAllFoldersBtn').addEventListener('click', function () {
          showAllFolders();
        });
      }

      function showRootLinks() {
        appState.currentFolderId = '';
        contentGrid.style.display = 'none';
        linksContainer.style.display = 'block';

        // æ›´æ–°æ ‡é¢˜
        currentFolderName.textContent = 'æ ¹ç›®å½•é“¾æ¥';
        currentFolderIcon.className = 'fas fa-home';

        // è·å–æ ¹ç›®å½•é“¾æ¥
        const rootLinks = appState.links
          .filter(link => link.folderId === '')
          .sort((a, b) => (a.order || 0) - (b.order || 0));

        // æ¸…ç©ºé“¾æ¥åˆ—è¡¨
        linksList.innerHTML = '';

        if (rootLinks.length === 0) {
          linksList.innerHTML = `
            <div class="empty-state" style="grid-column: 1 / -1;">
              <i class="fas fa-link"></i>
              <h3>æ ¹ç›®å½•æ²¡æœ‰é“¾æ¥</h3>
              <p>æ·»åŠ ä¸€äº›é“¾æ¥åˆ°æ ¹ç›®å½•å§ï¼</p>
            </div>
          `;
        } else {
          rootLinks.forEach(link => {
            const linkCard = createLinkCard(link, false);
            linksList.appendChild(linkCard);
          });
        }

        // æ›´æ–°é¢åŒ…å±‘å¯¼èˆª
        breadcrumb.innerHTML = `
          <div class="breadcrumb-item active" data-id="">æ ¹ç›®å½•</div>
          <div class="breadcrumb-separator">/</div>
          <div class="breadcrumb-item active">é“¾æ¥</div>
        `;

        backBtn.style.display = 'block';
      }

      function showAllFolders() {
        // æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶å¤¹çš„æ ‘çŠ¶è§†å›¾
        contentGrid.innerHTML = '';

        // æ„å»ºæ–‡ä»¶å¤¹æ ‘
        const folderTree = buildFolderTree();

        // æ¸²æŸ“æ–‡ä»¶å¤¹æ ‘
        renderFolderTree(folderTree);

        // æ›´æ–°é¢åŒ…å±‘å¯¼èˆª
        breadcrumb.innerHTML = `
          <div class="breadcrumb-item active" data-id="">æ ¹ç›®å½•</div>
          <div class="breadcrumb-separator">/</div>
          <div class="breadcrumb-item active">æ‰€æœ‰æ–‡ä»¶å¤¹</div>
        `;

        backBtn.style.display = 'block';
      }

      function buildFolderTree(parentId = '', level = 0) {
        const folders = appState.folders.filter(f => f.parentId === parentId);
        const tree = [];

        folders.forEach(folder => {
          const children = buildFolderTree(folder.id, level + 1);
          const linkCount = appState.links.filter(link => link.folderId === folder.id).length;

          tree.push({
            ...folder,
            level,
            children,
            linkCount
          });
        });

        return tree;
      }

      function renderFolderTree(tree) {
        tree.forEach(item => {
          const indent = item.level * 20;
          const folderCard = document.createElement('div');
          folderCard.className = 'folder-card';
          folderCard.style.marginLeft = `${indent}px`;
          folderCard.style.borderLeft = item.level > 0 ? `3px solid var(--primary-color)` : 'none';

          folderCard.innerHTML = `
            <div class="folder-header">
              <div class="folder-info">
                <div class="folder-icon" style="background: linear-gradient(135deg, #a5b4fc 0%, #818cf8 100%); opacity: ${1 - item.level * 0.1}">
                  <i class="fas fa-${item.icon || 'folder'}"></i>
                </div>
                <div class="folder-text">
                  <div class="folder-title">${item.name}</div>
                  <div class="folder-desc">${item.description || ''}</div>
                </div>
              </div>
              <div class="folder-actions">
                <button class="btn btn-small" data-id="${item.id}">
                  <i class="fas fa-folder-open"></i>
                </button>
                <button class="btn btn-small btn-secondary edit-folder-btn" data-id="${item.id}">
                  <i class="fas fa-edit"></i>
                </button>
              </div>
            </div>
            <div class="folder-stats">
              <span>${item.children.length} ä¸ªå­æ–‡ä»¶å¤¹</span>
              <span>${item.linkCount} ä¸ªé“¾æ¥</span>
            </div>
          `;

          contentGrid.appendChild(folderCard);

          // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
          folderCard.querySelector('button:first-child').addEventListener('click', function (e) {
            navigateToFolder(this.dataset.id);
          });

          folderCard.querySelector('.edit-folder-btn').addEventListener('click', function (e) {
            openFolderModal(this.dataset.id);
          });

          // é€’å½’æ¸²æŸ“å­æ–‡ä»¶å¤¹
          if (item.children.length > 0) {
            renderFolderTree(item.children);
          }
        });
      }

      function navigateToFolder(folderId) {
        // é€€å‡ºæ‰¹é‡é€‰æ‹©æ¨¡å¼
        if (appState.bulkSelectMode) {
          appState.bulkSelectMode = false;
          bulkSelectBtn.innerHTML = '<i class="fas fa-check-circle"></i><span class="desktop-only">æ‰¹é‡é€‰æ‹©</span>';
          bulkSelectBtn.style.background = 'var(--select-color)';
          bulkActionsBar.classList.remove('active');
          selectionModeHint.style.display = 'none';
          clearSelection();
        }

        appState.currentFolderId = folderId;
        renderCurrentView();
      }

      function updateBreadcrumb(folderId) {
        breadcrumb.innerHTML = '';

        // æ ¹ç›®å½•
        breadcrumb.innerHTML = '<div class="breadcrumb-item" data-id="">æ ¹ç›®å½•</div>';

        // å¦‚æœå½“å‰ä¸åœ¨æ ¹ç›®å½•ï¼Œæ„å»ºè·¯å¾„
        if (folderId) {
          const path = getFolderPath(folderId);
          path.forEach(folder => {
            breadcrumb.innerHTML += '<div class="breadcrumb-separator">/</div>';
            breadcrumb.innerHTML += `<div class="breadcrumb-item" data-id="${folder.id}">${folder.name}</div>`;
          });

          // æœ€åä¸€ä¸ªä¸ºå½“å‰æ–‡ä»¶å¤¹
          const lastItem = breadcrumb.querySelector('.breadcrumb-item:last-child');
          lastItem.classList.add('active');
        } else {
          // æ ¹ç›®å½•ä¸ºå½“å‰
          const rootItem = breadcrumb.querySelector('.breadcrumb-item');
          rootItem.classList.add('active');
        }

        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
        breadcrumb.querySelectorAll('.breadcrumb-item:not(.active)').forEach(item => {
          item.addEventListener('click', function () {
            navigateToFolder(this.dataset.id);
          });
        });
      }

      function getFolderPath(folderId) {
        const path = [];
        let currentId = folderId;

        while (currentId) {
          const folder = appState.folders.find(f => f.id === currentId);
          if (folder) {
            path.unshift(folder);
            currentId = folder.parentId;
          } else {
            break;
          }
        }

        return path;
      }

      function openFolderModal(folderId = null) {
        const modal = document.getElementById('folderModal');
        const title = document.getElementById('folderModalTitle');
        const form = document.getElementById('folderForm');
        const nameInput = document.getElementById('folderName');
        const descInput = document.getElementById('folderDescription');
        const parentSelect = document.getElementById('parentFolder');

        // é‡ç½®è¡¨å•
        form.reset();

        // å¡«å……çˆ¶æ–‡ä»¶å¤¹é€‰æ‹©
        parentSelect.innerHTML = '<option value="">æ—  (æ ¹ç›®å½•)</option>';

        appState.folders.forEach(folder => {
          // æ’é™¤å½“å‰æ–‡ä»¶å¤¹ï¼ˆé¿å…å¾ªç¯å¼•ç”¨ï¼‰
          if (folder.id !== folderId) {
            const option = document.createElement('option');
            option.value = folder.id;
            option.textContent = folder.name;

            // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼ä¸”å½“å‰æ–‡ä»¶å¤¹æœ‰çˆ¶æ–‡ä»¶å¤¹ï¼Œåˆ™é€‰ä¸­
            if (folderId) {
              const currentFolder = appState.folders.find(f => f.id === folderId);
              if (currentFolder && currentFolder.parentId === folder.id) {
                option.selected = true;
              }
            }

            parentSelect.appendChild(option);
          }
        });

        if (folderId) {
          // ç¼–è¾‘æ¨¡å¼
          appState.editingFolderId = folderId;
          title.textContent = 'ç¼–è¾‘æ–‡ä»¶å¤¹';
          const folder = appState.folders.find(f => f.id === folderId);
          if (folder) {
            nameInput.value = folder.name;
            descInput.value = folder.description || '';
          }
        } else {
          // æ–°å»ºæ¨¡å¼
          appState.editingFolderId = null;
          title.textContent = 'æ–°å»ºæ–‡ä»¶å¤¹';

          // é»˜è®¤é€‰æ‹©å½“å‰æ–‡ä»¶å¤¹ä½œä¸ºçˆ¶æ–‡ä»¶å¤¹
          if (appState.currentFolderId) {
            parentSelect.value = appState.currentFolderId;
          }
        }

        modal.classList.add('active');

        // èšç„¦åˆ°åç§°è¾“å…¥æ¡†
        setTimeout(() => nameInput.focus(), 100);
      }

      function openLinkModal(folderId = null) {
        const modal = document.getElementById('linkModal');
        const title = document.getElementById('linkModalTitle');
        const form = document.getElementById('linkForm');
        const nameInput = document.getElementById('linkName');
        const urlInput = document.getElementById('linkUrl');
        const notesInput = document.getElementById('linkNotes');
        const folderSelect = document.getElementById('linkFolder');

        // é‡ç½®è¡¨å•
        form.reset();
        appState.editingLinkId = null;
        title.textContent = 'æ·»åŠ é“¾æ¥';

        // å¡«å……æ–‡ä»¶å¤¹é€‰æ‹©
        folderSelect.innerHTML = '<option value="">æ—  (æ˜¾ç¤ºåœ¨æ ¹ç›®å½•)</option>';

        appState.folders.forEach(folder => {
          const option = document.createElement('option');
          option.value = folder.id;
          option.textContent = folder.name;
          folderSelect.appendChild(option);
        });

        // å¦‚æœæŒ‡å®šäº†æ–‡ä»¶å¤¹ï¼Œåˆ™é€‰ä¸­
        if (folderId !== null) {
          folderSelect.value = folderId;
        }

        modal.classList.add('active');

        // èšç„¦åˆ°åç§°è¾“å…¥æ¡†
        setTimeout(() => nameInput.focus(), 100);
      }

      function editLink(linkId) {
        const link = appState.links.find(l => l.id === linkId);
        if (!link) return;

        const modal = document.getElementById('linkModal');
        const title = document.getElementById('linkModalTitle');
        const form = document.getElementById('linkForm');
        const nameInput = document.getElementById('linkName');
        const urlInput = document.getElementById('linkUrl');
        const notesInput = document.getElementById('linkNotes');
        const folderSelect = document.getElementById('linkFolder');

        appState.editingLinkId = linkId;
        title.textContent = 'ç¼–è¾‘é“¾æ¥';

        // å¡«å……è¡¨å•
        nameInput.value = link.name;
        urlInput.value = link.url;
        notesInput.value = link.notes || '';

        // å¡«å……æ–‡ä»¶å¤¹é€‰æ‹©
        folderSelect.innerHTML = '<option value="">æ—  (æ˜¾ç¤ºåœ¨æ ¹ç›®å½•)</option>';

        appState.folders.forEach(folder => {
          const option = document.createElement('option');
          option.value = folder.id;
          option.textContent = folder.name;
          if (folder.id === link.folderId) {
            option.selected = true;
          }
          folderSelect.appendChild(option);
        });

        modal.classList.add('active');
      }

      function deleteLink(linkId) {
        const link = appState.links.find(l => l.id === linkId);
        if (!link) return;

        if (confirm(`ç¡®å®šè¦åˆ é™¤é“¾æ¥ "${link.name}" å—ï¼Ÿ`)) {
          appState.links = appState.links.filter(l => l.id !== linkId);
          saveData();
          renderCurrentView();
          showNotification('é“¾æ¥å·²åˆ é™¤', 'success');
        }
      }

      function deleteFolder(folderId) {
        const folder = appState.folders.find(f => f.id === folderId);
        if (!folder) return;

        // æ£€æŸ¥æ–‡ä»¶å¤¹ä¸­æ˜¯å¦æœ‰å­æ–‡ä»¶å¤¹
        const subfolders = appState.folders.filter(f => f.parentId === folderId);
        // æ£€æŸ¥æ–‡ä»¶å¤¹ä¸­æ˜¯å¦æœ‰é“¾æ¥
        const folderLinks = appState.links.filter(l => l.folderId === folderId);

        let message = `ç¡®å®šè¦åˆ é™¤æ–‡ä»¶å¤¹ "${folder.name}" å—ï¼Ÿ`;

        if (subfolders.length > 0 || folderLinks.length > 0) {
          message = `æ–‡ä»¶å¤¹ "${folder.name}" ä¸­åŒ…å« ${subfolders.length} ä¸ªå­æ–‡ä»¶å¤¹å’Œ ${folderLinks.length} ä¸ªé“¾æ¥ï¼Œåˆ é™¤æ–‡ä»¶å¤¹å°†åŒæ—¶åˆ é™¤è¿™äº›å†…å®¹ã€‚ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ`;
        }

        if (confirm(message)) {
          // åˆ é™¤æ–‡ä»¶å¤¹å’Œå…¶ä¸­çš„å†…å®¹
          appState.folders = appState.folders.filter(f => f.id !== folderId);
          appState.links = appState.links.filter(l => l.folderId !== folderId);

          // é€’å½’åˆ é™¤å­æ–‡ä»¶å¤¹
          function deleteSubfolders(parentId) {
            const children = appState.folders.filter(f => f.parentId === parentId);
            children.forEach(child => {
              appState.folders = appState.folders.filter(f => f.id !== child.id);
              appState.links = appState.links.filter(l => l.folderId !== child.id);
              deleteSubfolders(child.id);
            });
          }

          deleteSubfolders(folderId);

          saveData();
          renderCurrentView();
          showNotification('æ–‡ä»¶å¤¹å·²åˆ é™¤', 'success');
        }
      }

      function showNotification(message, type = 'info') {
        notification.textContent = message;
        notification.className = `notification ${type}`;
        notification.classList.add('show');

        setTimeout(() => {
          notification.classList.remove('show');
        }, 3000);
      }

      function updateLastSyncDisplay() {
        if (appState.lastSync) {
          const date = new Date(appState.lastSync);
          lastSyncTime.textContent = date.toLocaleString('zh-CN');
        } else {
          lastSyncTime.textContent = 'ä»æœªåŒæ­¥';
        }
      }

      function setTheme(theme) {
        // æ¸…é™¤ç°æœ‰ä¸»é¢˜ç±»
        document.body.classList.remove('dark-mode');

        if (theme === 'dark') {
          document.body.classList.add('dark-mode');
          document.getElementById('themeIcon').className = 'fas fa-sun';
        } else if (theme === 'light') {
          document.getElementById('themeIcon').className = 'fas fa-moon';
        } else if (theme === 'auto') {
          // è‡ªåŠ¨æ¨¡å¼ï¼šæ ¹æ®ç³»ç»Ÿåå¥½è®¾ç½®
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          if (prefersDark) {
            document.body.classList.add('dark-mode');
            document.getElementById('themeIcon').className = 'fas fa-sun';
          } else {
            document.getElementById('themeIcon').className = 'fas fa-moon';
          }
        }

        appState.theme = theme;
        localStorage.setItem('theme', theme);
      }

      // å¯¼å‡ºæ‰€æœ‰é“¾æ¥ä¸ºHTMLæ–‡ä»¶
      function exportAllLinks() {
        const timestamp = new Date().toISOString().split('T')[0];
        const fileName = `æˆ‘çš„å¯¼èˆªé“¾æ¥-${timestamp}.html`;

        // æ„å»ºæ–‡ä»¶å¤¹æ ‘
        const folderTree = buildFolderTreeForExport();
        const rootLinks = appState.links
          .filter(link => !link.folderId)
          .sort((a, b) => (a.order || 0) - (b.order || 0));

        // ç”ŸæˆHTMLå†…å®¹
        const htmlContent = generateHtmlExport(folderTree, rootLinks);

        // åˆ›å»ºBlobå¹¶ä¸‹è½½
        const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showNotification(`å·²å¯¼å‡º${appState.links.length}ä¸ªé“¾æ¥åˆ°HTMLæ–‡ä»¶`, 'success');
      }

      // ä¸ºå¯¼å‡ºæ„å»ºæ–‡ä»¶å¤¹æ ‘
      function buildFolderTreeForExport(parentId = '') {
        const folders = appState.folders.filter(f => f.parentId === parentId);
        const tree = [];

        folders.forEach(folder => {
          const children = buildFolderTreeForExport(folder.id);
          const folderLinks = appState.links
            .filter(link => link.folderId === folder.id)
            .sort((a, b) => (a.order || 0) - (b.order || 0));

          tree.push({
            ...folder,
            children,
            links: folderLinks
          });
        });

        return tree;
      }

      // ç”ŸæˆHTMLå¯¼å‡ºå†…å®¹
      function generateHtmlExport(folderTree, rootLinks) {
        const totalLinks = appState.links.length;
        const totalFolders = appState.folders.length;
        const exportDate = new Date().toLocaleString('zh-CN');

        return `<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æˆ‘çš„å¯¼èˆªé“¾æ¥ - ${exportDate}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.5; padding: 20px; max-width: 1200px; margin: 0 auto; }
    .header { text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #e2e8f0; }
    .header h1 { color: #4f46e5; margin-bottom: 10px; }
    .stats { display: flex; justify-content: center; gap: 30px; margin: 20px 0; flex-wrap: wrap; }
    .stat-item { text-align: center; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); min-width: 120px; }
    .stat-value { font-size: 24px; font-weight: bold; color: #4f46e5; }
    .stat-label { font-size: 14px; color: #64748b; }
    .folder-section { margin-bottom: 40px; }
    .folder-header { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 15px 20px; border-radius: 10px 10px 0 0; display: flex; align-items: center; gap: 10px; margin-bottom: 0; }
    .folder-content { background: white; border-radius: 0 0 10px 10px; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .link-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
    .link-item { background: #f8fafc; border-radius: 8px; padding: 15px; border: 1px solid #e2e8f0; transition: all 0.3s ease; }
    .link-item:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); border-color: #4f46e5; }
    .link-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .link-title { font-weight: 600; font-size: 16px; color: #1e293b; margin-bottom: 4px; }
    .link-url { font-size: 12px; color: #64748b; word-break: break-all; }
    .link-notes { font-size: 13px; color: #475569; line-height: 1.5; margin-top: 10px; padding: 10px; background: rgba(79, 70, 229, 0.05); border-radius: 6px; border-left: 3px solid #4f46e5; }
    .subfolder { margin-left: 20px; margin-top: 20px; border-left: 3px solid #a5b4fc; padding-left: 20px; }
    .footer { text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #e2e8f0; color: #64748b; font-size: 14px; }
    @media (max-width: 768px) { .link-grid { grid-template-columns: 1fr; } .stats { gap: 15px; } .stat-item { min-width: 100px; } }
  </style>
</head>
<body>
  <div class="header">
    <h1>æˆ‘çš„å¯¼èˆªé“¾æ¥</h1>
    <p>å¯¼å‡ºæ—¶é—´ï¼š${exportDate}</p>
    <div class="stats">
      <div class="stat-item"><div class="stat-value">${totalLinks}</div><div class="stat-label">ä¸ªé“¾æ¥</div></div>
      <div class="stat-item"><div class="stat-value">${totalFolders}</div><div class="stat-label">ä¸ªæ–‡ä»¶å¤¹</div></div>
    </div>
  </div>
  ${generateHtmlFolderTree(folderTree, rootLinks)}
  <div class="footer">
    <p>ä¸ªäººå¯¼èˆªé¡µ &copy; ${new Date().getFullYear()} | ç”Ÿæˆæ—¶é—´ï¼š${exportDate}</p>
    <p>æ€»é“¾æ¥æ•°ï¼š${totalLinks} | æ€»æ–‡ä»¶å¤¹æ•°ï¼š${totalFolders}</p>
  </div>
</body>
</html>`;
      }

      // ç”ŸæˆHTMLæ–‡ä»¶å¤¹æ ‘
      function generateHtmlFolderTree(folderTree, rootLinks = [], level = 0) {
        let html = '';

        // æ¸²æŸ“æ ¹ç›®å½•é“¾æ¥
        if (rootLinks.length > 0 && level === 0) {
          html += `
            <div class="folder-section">
              <div class="folder-header">
                <h2>æ ¹ç›®å½•é“¾æ¥</h2>
              </div>
              <div class="folder-content">
                <div class="link-grid">
          `;

          rootLinks.forEach(link => {
            html += `
              <div class="link-item">
                <div class="link-header">
                  <div>
                    <div class="link-title">${link.name}</div>
                    <div class="link-url">${link.url}</div>
                  </div>
                </div>
                ${link.notes ? `<div class="link-notes">${link.notes}</div>` : ''}
              </div>
            `;
          });

          html += `
                </div>
              </div>
            </div>
          `;
        }

        // æ¸²æŸ“æ–‡ä»¶å¤¹æ ‘
        folderTree.forEach(folder => {
          const indentClass = level > 0 ? ' subfolder' : '';

          html += `
            <div class="folder-section${indentClass}">
              <div class="folder-header">
                <h2>${folder.name}${folder.description ? ` - ${folder.description}` : ''}</h2>
              </div>
              <div class="folder-content">
          `;

          if (folder.links.length > 0) {
            html += '<div class="link-grid">';

            folder.links.forEach(link => {
              html += `
                <div class="link-item">
                  <div class="link-header">
                    <div>
                      <div class="link-title">${link.name}</div>
                      <div class="link-url">${link.url}</div>
                    </div>
                  </div>
                  ${link.notes ? `<div class="link-notes">${link.notes}</div>` : ''}
                </div>
              `;
            });

            html += '</div>';
          } else {
            html += '<p style="color: #64748b; text-align: center; padding: 20px;">æ­¤æ–‡ä»¶å¤¹æš‚æ— é“¾æ¥</p>';
          }

          // é€’å½’æ¸²æŸ“å­æ–‡ä»¶å¤¹
          if (folder.children.length > 0) {
            html += generateHtmlFolderTree(folder.children, [], level + 1);
          }

          html += `
              </div>
            </div>
          `;
        });

        return html;
      }

      function setupEventListeners() {
        // æ·»åŠ æ–‡ä»¶å¤¹æŒ‰é’®
        document.getElementById('addFolderBtn').addEventListener('click', () => openFolderModal());

        // æ·»åŠ é“¾æ¥æŒ‰é’®
        document.getElementById('addLinkBtn').addEventListener('click', () => openLinkModal(appState.currentFolderId));

        // å¯¼å‡ºæ‰€æœ‰é“¾æ¥æŒ‰é’®
        document.getElementById('exportAllBtn').addEventListener('click', exportAllLinks);

        // æ‰¹é‡é€‰æ‹©æŒ‰é’®
        bulkSelectBtn.addEventListener('click', toggleBulkSelectMode);

        // å…¨é€‰æŒ‰é’®
        selectAllBtn.addEventListener('click', selectAllLinks);

        // åé€‰æŒ‰é’®
        invertSelectionBtn.addEventListener('click', invertSelection);

        // è®¿é—®é€‰ä¸­é“¾æ¥æŒ‰é’® - ä¿®å¤ç‰ˆæœ¬
        openSelectedBtn.addEventListener('click', openSelectedLinks);

        // ç§»åŠ¨é€‰ä¸­é“¾æ¥æŒ‰é’®
        moveSelectedBtn.addEventListener('click', moveSelectedLinks);

        // æ¸…ç©ºé€‰æ‹©æŒ‰é’®
        clearSelectionBtn.addEventListener('click', clearSelection);

        // æ·»åŠ åˆ°å½“å‰æ–‡ä»¶å¤¹æŒ‰é’®
        document.getElementById('addLinkToCurrentBtn').addEventListener('click', () => {
          openLinkModal(appState.currentFolderId);
        });

        // æ·»åŠ å­æ–‡ä»¶å¤¹æŒ‰é’®
        document.getElementById('addSubfolderBtn').addEventListener('click', () => {
          openFolderModal();
        });

        // è¿”å›æŒ‰é’®
        backBtn.addEventListener('click', function () {
          if (appState.currentFolderId === '') {
            // è¿”å›æ ¹ç›®å½•
            linksContainer.style.display = 'none';
            contentGrid.style.display = 'grid';
            appState.currentFolderId = '';
            backBtn.style.display = 'none';
            renderCurrentView();
          } else {
            // è¿”å›ä¸Šçº§æ–‡ä»¶å¤¹
            const currentFolder = appState.folders.find(f => f.id === appState.currentFolderId);
            if (currentFolder) {
              navigateToFolder(currentFolder.parentId || '');
            }
          }
        });

        // è®¾ç½®æŒ‰é’®
        document.getElementById('settingsBtn').addEventListener('click', () => {
          document.getElementById('settingsModal').classList.add('active');

          // å¡«å……è®¾ç½®è¡¨å•
          document.getElementById('githubToken').value = appState.githubToken;
          document.getElementById('gistId').value = appState.gistId;

          // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
          document.getElementById('tokenStatus').textContent = appState.githubToken ? 'å·²é…ç½®' : 'æœªé…ç½®';
          document.getElementById('currentGistId').textContent = appState.gistId || 'æœªè®¾ç½®';
        });

        // æ–‡ä»¶å¤¹è¡¨å•æäº¤
        document.getElementById('folderForm').addEventListener('submit', function (e) {
          e.preventDefault();

          const name = document.getElementById('folderName').value.trim();
          const description = document.getElementById('folderDescription').value.trim();
          const parentId = document.getElementById('parentFolder').value || '';

          if (!name) {
            showNotification('è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°', 'error');
            return;
          }

          if (appState.editingFolderId) {
            // æ›´æ–°ç°æœ‰æ–‡ä»¶å¤¹
            const folder = appState.folders.find(f => f.id === appState.editingFolderId);
            if (folder) {
              folder.name = name;
              folder.description = description;
              folder.parentId = parentId;
              folder.updatedAt = Date.now();
            }
          } else {
            // åˆ›å»ºæ–°æ–‡ä»¶å¤¹
            const newFolder = {
              id: 'folder_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
              name,
              description,
              parentId,
              icon: 'folder',
              order: appState.folders.filter(f => f.parentId === parentId).length + 1,
              createdAt: Date.now()
            };

            appState.folders.push(newFolder);
          }

          saveData();
          renderCurrentView();
          document.getElementById('folderModal').classList.remove('active');
          showNotification(appState.editingFolderId ? 'æ–‡ä»¶å¤¹å·²æ›´æ–°' : 'æ–‡ä»¶å¤¹å·²åˆ›å»º', 'success');
          appState.editingFolderId = null;
        });

        // é“¾æ¥è¡¨å•æäº¤
        document.getElementById('linkForm').addEventListener('submit', async function (e) {
          e.preventDefault();

          const name = document.getElementById('linkName').value.trim();
          let url = document.getElementById('linkUrl').value.trim();
          const folderId = document.getElementById('linkFolder').value;
          const notes = document.getElementById('linkNotes').value.trim();

          if (!name) {
            showNotification('è¯·è¾“å…¥é“¾æ¥åç§°', 'error');
            return;
          }

          if (!url) {
            showNotification('è¯·è¾“å…¥URL', 'error');
            return;
          }

          // ç¡®ä¿URLæœ‰åè®®å‰ç¼€
          if (!url.startsWith('http://') && !url.startsWith('https://')) {
            url = 'https://' + url;
          }

          if (appState.editingLinkId) {
            // æ›´æ–°ç°æœ‰é“¾æ¥
            const link = appState.links.find(l => l.id === appState.editingLinkId);
            if (link) {
              link.name = name;
              link.url = url;
              link.folderId = folderId;
              link.notes = notes;
              link.updatedAt = Date.now();
            }
          } else {
            // åˆ›å»ºæ–°é“¾æ¥
            const newLink = {
              id: 'link_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
              name,
              url,
              folderId,
              notes,
              icon: '',
              order: appState.links.filter(l => l.folderId === folderId).length + 1,
              createdAt: Date.now()
            };

            appState.links.push(newLink);
          }

          saveData();
          renderCurrentView();
          document.getElementById('linkModal').classList.remove('active');
          showNotification(appState.editingLinkId ? 'é“¾æ¥å·²æ›´æ–°' : 'é“¾æ¥å·²æ·»åŠ ', 'success');
          appState.editingLinkId = null;
        });

        // æ‰“å¼€é“¾æ¥æ¨¡æ€æ¡†ç›¸å…³äº‹ä»¶
        document.getElementById('openLinksConfirmBtn').addEventListener('click', executeOpenLinks);

        document.getElementById('openLinksCancelBtn').addEventListener('click', function () {
          document.getElementById('openLinksModal').classList.remove('active');
        });

        document.getElementById('openLinksModalClose').addEventListener('click', function () {
          document.getElementById('openLinksModal').classList.remove('active');
        });

        // ç§»åŠ¨é“¾æ¥æ¨¡æ€æ¡†ç›¸å…³äº‹ä»¶
        document.getElementById('moveLinksConfirmBtn').addEventListener('click', function () {
          const targetFolderId = document.getElementById('moveTargetFolder').value;
          executeMoveLinks(targetFolderId);
        });

        document.getElementById('moveLinksCancelBtn').addEventListener('click', function () {
          document.getElementById('moveLinksModal').classList.remove('active');
        });

        document.getElementById('moveLinksModalClose').addEventListener('click', function () {
          document
