<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的工具仓库导航</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 20px;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .controls {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #95a5a6;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }
        
        .btn-secondary:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
        }
        
        .stats {
            margin-left: auto;
            color: #7f8c8d;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .tools-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .tools-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .tool-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.12);
        }
        
        .tool-icon {
            height: 120px;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }
        
        .tool-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .tool-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .tool-desc {
            color: #7f8c8d;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
            flex: 1;
        }
        
        .tool-link {
            display: inline-block;
            padding: 10px 15px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
        }
        
        .tool-link:hover {
            background: #2980b9;
        }
        
        .tool-link i {
            margin-left: 5px;
        }
        
        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #e0e6ed;
            margin-top: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #3498db;
        }
        
        .github-info {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .instructions {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .instructions h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions p {
            color: #7f8c8d;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .error-message {
            background: #ffeaa7;
            border-left: 4px solid #fdcb6e;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #2d3436;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-tools"></i> 我的工具仓库</h1>
            <p class="subtitle">GitHub仓库中的实用工具集合</p>
        </header>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> 使用说明</h3>
            <p>1. 点击"扫描仓库"按钮自动扫描GitHub仓库中的所有工具</p>
            <p>2. 扫描到的工具会显示在下方，点击工具名称即可直接使用</p>
            <p>3. 使用搜索框可以快速查找特定工具</p>
            <p>4. 所有工具都会自动命名，而不是显示为"index"</p>
        </div>
        
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="搜索工具...">
            </div>
            
            <button id="scanBtn" class="btn btn-primary">
                <i class="fas fa-sync-alt"></i> 扫描仓库
            </button>
            
            <div class="stats">
                找到 <span id="toolCount">0</span> 个工具
            </div>
        </div>
        
        <div id="toolsContainer" class="tools-grid">
            <!-- 工具卡片将在这里动态生成 -->
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>准备就绪，点击上方"扫描仓库"按钮开始</p>
            </div>
        </div>
        
        <div class="github-info">
            <p><i class="fab fa-github"></i> 仓库地址: <a href="https://github.com/linsheng135/my-tools" target="_blank">https://github.com/linsheng135/my-tools</a></p>
            <p>此页面会自动扫描您的GitHub仓库，识别工具文件夹并创建可直接使用的链接。</p>
        </div>
        
        <footer>
            <p>我的工具仓库导航 &copy; 2023 | 自动扫描GitHub工具</p>
        </footer>
    </div>

    <script>
        // 配置信息
        const GITHUB_USERNAME = 'linsheng135';
        const GITHUB_REPO = 'my-tools';
        const GITHUB_API_BASE = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents`;
        
        // 工具数据缓存
        let allTools = [];
        let filteredTools = [];
        
        // DOM元素
        const toolsContainer = document.getElementById('toolsContainer');
        const searchInput = document.getElementById('searchInput');
        const scanBtn = document.getElementById('scanBtn');
        const toolCount = document.getElementById('toolCount');
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 绑定事件
            scanBtn.addEventListener('click', scanRepository);
            searchInput.addEventListener('input', filterTools);
            
            // 显示初始状态
            updateToolCount();
        });
        
        // 扫描仓库函数
        async function scanRepository() {
            try {
                // 显示加载状态
                toolsContainer.innerHTML = `
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>正在扫描GitHub仓库，请稍候...</p>
                    </div>
                `;
                
                // 获取仓库根目录内容
                const response = await fetch(GITHUB_API_BASE);
                
                if (!response.ok) {
                    throw new Error(`GitHub API请求失败: ${response.status}`);
                }
                
                const contents = await response.json();
                
                // 过滤出目录（工具文件夹）
                const directories = contents.filter(item => item.type === 'dir');
                
                // 获取每个目录的详细信息
                allTools = [];
                
                for (const dir of directories) {
                    try {
                        // 获取目录内容
                        const dirResponse = await fetch(dir.url);
                        const dirContents = await dirResponse.json();
                        
                        // 寻找入口文件（优先查找index.html，然后是其他html文件）
                        let entryFile = dirContents.find(file => 
                            file.name.toLowerCase() === 'index.html' && 
                            file.type === 'file'
                        );
                        
                        // 如果没有index.html，找第一个html文件
                        if (!entryFile) {
                            entryFile = dirContents.find(file => 
                                file.name.toLowerCase().endsWith('.html') && 
                                file.type === 'file'
                            );
                        }
                        
                        // 如果有入口文件，则添加到工具列表
                        if (entryFile) {
                            // 生成友好的工具名称（基于目录名）
                            const friendlyName = generateFriendlyName(dir.name);
                            
                            // 工具描述
                            const description = getToolDescription(dir.name);
                            
                            // 工具图标（基于工具类型）
                            const icon = getToolIcon(dir.name);
                            
                            // GitHub Pages URL
                            const toolUrl = `https://${GITHUB_USERNAME}.github.io/${GITHUB_REPO}/${dir.name}/${entryFile.name}`;
                            
                            allTools.push({
                                id: dir.name,
                                name: friendlyName,
                                description: description,
                                icon: icon,
                                folder: dir.name,
                                url: toolUrl,
                                rawUrl: entryFile.download_url
                            });
                        }
                    } catch (dirError) {
                        console.error(`获取目录 ${dir.name} 内容时出错:`, dirError);
                    }
                }
                
                // 更新工具显示
                filteredTools = [...allTools];
                renderTools();
                updateToolCount();
                
            } catch (error) {
                console.error('扫描仓库时出错:', error);
                toolsContainer.innerHTML = `
                    <div class="error-message">
                        <h3><i class="fas fa-exclamation-triangle"></i> 扫描失败</h3>
                        <p>错误信息: ${error.message}</p>
                        <p>请检查网络连接，确保仓库是公开的，然后重试。</p>
                    </div>
                `;
            }
        }
        
        // 渲染工具卡片
        function renderTools() {
            if (filteredTools.length === 0) {
                toolsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <h3>没有找到工具</h3>
                        <p>${allTools.length === 0 ? '请点击"扫描仓库"按钮扫描您的GitHub仓库' : '没有匹配搜索条件的工具'}</p>
                    </div>
                `;
                return;
            }
            
            toolsContainer.innerHTML = '';
            
            filteredTools.forEach(tool => {
                const toolCard = document.createElement('div');
                toolCard.className = 'tool-card';
                
                toolCard.innerHTML = `
                    <div class="tool-icon">
                        <i class="${tool.icon}"></i>
                    </div>
                    <div class="tool-content">
                        <h3 class="tool-title">${tool.name}</h3>
                        <p class="tool-desc">${tool.description}</p>
                        <a href="${tool.url}" target="_blank" class="tool-link">
                            使用此工具 <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                `;
                
                toolsContainer.appendChild(toolCard);
            });
        }
        
        // 过滤工具函数
        function filterTools() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                filteredTools = [...allTools];
            } else {
                filteredTools = allTools.filter(tool => 
                    tool.name.toLowerCase().includes(searchTerm) || 
                    tool.description.toLowerCase().includes(searchTerm) ||
                    tool.folder.toLowerCase().includes(searchTerm)
                );
            }
            
            renderTools();
            updateToolCount();
        }
        
        // 更新工具计数
        function updateToolCount() {
            toolCount.textContent = filteredTools.length;
        }
        
        // 生成友好名称（将目录名转换为友好的显示名称）
        function generateFriendlyName(dirName) {
            // 移除常见的前缀/后缀
            let name = dirName
                .replace(/^my-/, '')
                .replace(/^-/, '')
                .replace(/-tool$/, '')
                .replace(/tool-/, '')
                .replace(/-util$/, '')
                .replace(/util-/, '');
            
            // 将短横线转换为空格
            name = name.replace(/-/g, ' ');
            
            // 将下划线转换为空格
            name = name.replace(/_/g, ' ');
            
            // 将每个单词首字母大写
            name = name.replace(/\b\w/g, char => char.toUpperCase());
            
            // 处理常见的缩写
            name = name.replace(/\bHtml\b/i, 'HTML')
                       .replace(/\bCss\b/i, 'CSS')
                       .replace(/\bJs\b/i, 'JavaScript')
                       .replace(/\bApi\b/i, 'API')
                       .replace(/\bJson\b/i, 'JSON');
            
            return name || dirName;
        }
        
        // 根据工具名称获取描述
        function getToolDescription(dirName) {
            const descriptions = {
                'calculator': '一个实用的在线计算器，支持基本运算和科学计算',
                'converter': '多功能单位转换工具，支持长度、重量、温度等',
                'generator': '数据生成器，可生成随机数据、密码等',
                'formatter': '代码格式化工具，支持多种编程语言',
                'validator': '数据验证工具，检查JSON、XML等格式',
                'encoder': '编码解码工具，支持Base64、URL等编码',
                'analyzer': '数据分析工具，提供数据统计和可视化',
                'editor': '在线编辑器，支持实时预览',
                'viewer': '文件查看器，支持多种格式',
                'organizer': '数据整理工具，帮助整理和分类信息'
            };
            
            const lowerName = dirName.toLowerCase();
            
            // 检查是否有匹配的关键词
            for (const [key, desc] of Object.entries(descriptions)) {
                if (lowerName.includes(key)) {
                    return desc;
                }
            }
            
            // 默认描述
            return `一个实用的 ${generateFriendlyName(dirName)} 工具，提供便捷的在线功能`;
        }
        
        // 根据工具名称获取图标
        function getToolIcon(dirName) {
            const lowerName = dirName.toLowerCase();
            
            if (lowerName.includes('calc') || lowerName.includes('math')) {
                return 'fas fa-calculator';
            } else if (lowerName.includes('convert') || lowerName.includes('transform')) {
                return 'fas fa-exchange-alt';
            } else if (lowerName.includes('generat') || lowerName.includes('create')) {
                return 'fas fa-cogs';
            } else if (lowerName.includes('format') || lowerName.includes('beautify')) {
                return 'fas fa-code';
            } else if (lowerName.includes('validat') || lowerName.includes('check')) {
                return 'fas fa-check-circle';
            } else if (lowerName.includes('encod') || lowerName.includes('decod')) {
                return 'fas fa-key';
            } else if (lowerName.includes('analyz') || lowerName.includes('stat')) {
                return 'fas fa-chart-bar';
            } else if (lowerName.includes('edit') || lowerName.includes('write')) {
                return 'fas fa-edit';
            } else if (lowerName.includes('view') || lowerName.includes('show')) {
                return 'fas fa-eye';
            } else if (lowerName.includes('organiz') || lowerName.includes('sort')) {
                return 'fas fa-folder-open';
            } else if (lowerName.includes('image') || lowerName.includes('picture')) {
                return 'fas fa-image';
            } else if (lowerName.includes('text') || lowerName.includes('string')) {
                return 'fas fa-font';
            } else if (lowerName.includes('date') || lowerName.includes('time')) {
                return 'fas fa-calendar-alt';
            } else if (lowerName.includes('color') || lowerName.includes('palette')) {
                return 'fas fa-palette';
            } else if (lowerName.includes('file') || lowerName.includes('document')) {
                return 'fas fa-file-alt';
            } else if (lowerName.includes('url') || lowerName.includes('link')) {
                return 'fas fa-link';
            } else if (lowerName.includes('qr') || lowerName.includes('barcode')) {
                return 'fas fa-qrcode';
            } else if (lowerName.includes('chart') || lowerName.includes('graph')) {
                return 'fas fa-chart-pie';
            } else {
                // 默认图标
                return 'fas fa-toolbox';
            }
        }
        
        // 初始加载完成后显示提示
        setTimeout(() => {
            if (toolsContainer.querySelector('.loading')) {
                toolsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-mouse-pointer"></i>
                        <h3>准备扫描</h3>
                        <p>点击上方的"扫描仓库"按钮开始扫描您的GitHub工具仓库</p>
                    </div>
                `;
            }
        }, 2000);
    </script>
</body>
</html>