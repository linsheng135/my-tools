<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„AIå·¥å…·é›† - ç²¾ç¡®æ‰«æç‰ˆ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --light-bg: #f8f9fa;
            --text-primary: #333;
            --text-secondary: #666;
            --text-light: #888;
            --border-color: #e0e0e0;
            --card-shadow: 0 3px 10px rgba(0,0,0,0.08);
            --hover-shadow: 0 5px 15px rgba(102, 126, 234, 0.12);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 12px;
            color: var(--text-primary);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
            min-height: calc(100vh - 24px);
        }
        
        /* å¤´éƒ¨ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .header-left h1 {
            font-size: 1.6rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-left .subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* å·¥å…·ç»Ÿè®¡ */
        .stats-bar {
            display: flex;
            gap: 15px;
            background: var(--light-bg);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
        }
        
        .stat-number {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }
        
        /* æ§åˆ¶æ  */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .search-box {
            flex: 1;
            max-width: 300px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 8px 15px 8px 35px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.85rem;
            background: var(--light-bg);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* åˆ†é¡µæ§åˆ¶ */
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .page-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        /* å·¥å…·ç½‘æ ¼ - è¶…ç´§å‡‘ */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        /* è¶…ç´§å‡‘å¡ç‰‡ */
        .tool-card {
            background: var(--light-bg);
            border-radius: 10px;
            padding: 15px;
            transition: all 0.2s;
            border: 1px solid transparent;
            text-decoration: none;
            color: var(--text-primary);
            display: block;
            position: relative;
            min-height: 120px;
        }
        
        .tool-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
            border-color: var(--primary-color);
            background: white;
        }
        
        .tool-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .tool-name {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .tool-folder {
            font-size: 0.75rem;
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 6px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .tool-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* ç©ºçŠ¶æ€ */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 30px 20px;
            color: var(--text-light);
        }
        
        .empty-state i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--border-color);
        }
        
        /* åŠ è½½çŠ¶æ€ */
        .loading-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(102, 126, 234, 0.2);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--light-bg);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4CAF50;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 7px 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.75rem;
        }
        
        /* é¡µè„š */
        .footer {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 0.8rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 8px;
        }
        
        .footer-links a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                padding: 8px;
            }
            
            .container {
                padding: 15px;
                border-radius: 12px;
            }
            
            .header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tools-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
            }
            
            .tool-card {
                padding: 12px;
                min-height: 110px;
            }
            
            .tool-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .tool-name {
                font-size: 0.9rem;
            }
            
            .tool-desc {
                font-size: 0.75rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                max-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .tools-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-bar {
                justify-content: space-around;
            }
        }
        
        /* å¹³æ¿ä¼˜åŒ– */
        @media (min-width: 769px) and (max-width: 1024px) {
            .tools-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 14px;
            }
        }
        
        /* å¤§å±å¹•ä¼˜åŒ– */
        @media (min-width: 1400px) {
            .tools-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        
        /* ç›®å½•ç»“æ„æ˜¾ç¤º */
        .folder-structure {
            background: #f0f4ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .folder-structure h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 0.9rem;
        }
        
        .folder-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            padding-left: 20px;
        }
        
        .folder-item i {
            margin-right: 8px;
            color: var(--primary-color);
            font-size: 0.8rem;
        }
        
        /* æ‰«æé…ç½® */
        .scan-config {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .config-input {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.85rem;
            flex: 1;
            max-width: 300px;
        }
        
        /* é”™è¯¯æç¤º */
        .error-box {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.85rem;
        }
        
        .error-box i {
            color: #f44336;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="header-left">
                <h1><i class="fas fa-tools"></i> æˆ‘çš„AIå·¥å…·é›†</h1>
                <p class="subtitle">ç²¾ç¡®æ‰«ææ‰€æœ‰å­ç›®å½•ï¼Œåªæ˜¾ç¤ºå®é™…å­˜åœ¨çš„å·¥å…·</p>
            </div>
            
            <div class="header-right">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusText">ç‚¹å‡»æ‰«ææŒ‰é’®å¼€å§‹</span>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="startScan()" id="scanBtn">
                        <i class="fas fa-search"></i> æ‰«æå·¥å…·
                    </button>
                    <button class="btn btn-small" onclick="showScanConfig()" title="æ‰«æé…ç½®">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- æ‰«æé…ç½®é¢æ¿ï¼ˆé»˜è®¤éšè—ï¼‰ -->
        <div class="scan-config" id="scanConfigPanel" style="display: none;">
            <input type="text" class="config-input" id="rootPath" placeholder="æ‰«ææ ¹ç›®å½•ï¼ˆé»˜è®¤ï¼š/ï¼‰" value="/">
            <button class="btn btn-small" onclick="updateScanConfig()">æ›´æ–°é…ç½®</button>
            <button class="btn btn-small" onclick="hideScanConfig()">éšè—</button>
        </div>
        
        <!-- å·¥å…·ç»Ÿè®¡ -->
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-number" id="totalTools">0</span>
                <span class="stat-label">æ€»å·¥å…·æ•°</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="scannedFolders">0</span>
                <span class="stat-label">å·²æ‰«ææ–‡ä»¶å¤¹</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="lastUpdate">-</span>
                <span class="stat-label">ä¸Šæ¬¡æ‰«æ</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="pageInfo">1/1</span>
                <span class="stat-label">å½“å‰é¡µ</span>
            </div>
        </div>
        
        <!-- æ§åˆ¶æ  -->
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢å·¥å…·åç§°æˆ–æ–‡ä»¶å¤¹..." onkeyup="searchTools()">
            </div>
            
            <div class="pagination-controls">
                <button class="pagination-btn" onclick="prevPage()" id="prevBtn" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span class="page-info" id="pageInfoText">ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
                <button class="pagination-btn" onclick="nextPage()" id="nextBtn" disabled>
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
        
        <!-- ç›®å½•ç»“æ„æ˜¾ç¤ºï¼ˆæ‰«æåæ˜¾ç¤ºï¼‰ -->
        <div class="folder-structure" id="folderStructure" style="display: none;">
            <h4><i class="fas fa-folder-tree"></i> æ‰«æåˆ°çš„ç›®å½•ç»“æ„</h4>
            <div id="structureContent"></div>
        </div>
        
        <!-- å·¥å…·ç½‘æ ¼ -->
        <div class="tools-grid" id="toolsGrid">
            <div class="loading-state" id="initialState">
                <div class="spinner"></div>
                <p>ç‚¹å‡»"æ‰«æå·¥å…·"æŒ‰é’®å¼€å§‹æ‰«ææ‚¨çš„å·¥å…·</p>
                <button class="btn btn-primary" onclick="startScan()" style="margin-top: 15px;">
                    <i class="fas fa-search"></i> å¼€å§‹æ‰«æ
                </button>
            </div>
        </div>
        
        <!-- ç©ºçŠ¶æ€æç¤º -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <i class="fas fa-folder-open"></i>
            <h3>æœªå‘ç°ä»»ä½•å·¥å…·</h3>
            <p>è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ·»åŠ å·¥å…·ï¼š</p>
            <ol style="text-align: left; max-width: 300px; margin: 10px auto; padding-left: 20px; font-size: 0.85rem;">
                <li>åœ¨GitHubä»“åº“ä¸­åˆ›å»ºæ–°æ–‡ä»¶å¤¹</li>
                <li>åœ¨æ–‡ä»¶å¤¹ä¸­åˆ›å»º index.html æ–‡ä»¶</li>
                <li>å°†å·¥å…·ä»£ç æ”¾å…¥ index.html</li>
                <li>ç‚¹å‡»"æ‰«æå·¥å…·"æŒ‰é’®é‡æ–°æ‰«æ</li>
            </ol>
        </div>
        
        <!-- é¡µè„š -->
        <div class="footer">
            <div class="footer-links">
                <a href="https://github.com/linsheng135/my-tools" target="_blank">GitHubä»“åº“</a>
                <a href="javascript:void(0)" onclick="clearSearch()">æ¸…é™¤æœç´¢</a>
                <a href="javascript:void(0)" onclick="showHelp()">ä½¿ç”¨å¸®åŠ©</a>
            </div>
            <p>ğŸ“ ç²¾ç¡®æ‰«ææ‰€æœ‰å­ç›®å½•ï¼ŒåŒ…æ‹¬åµŒå¥—æ–‡ä»¶å¤¹</p>
            <p>ğŸ”„ æ‰‹åŠ¨æ‰«ææ¨¡å¼ï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æ‰«æ</p>
            <p>Â© 2024 æˆ‘çš„AIå·¥å…·é›† | ç²¾ç¡®æ‰«æç‰ˆ</p>
        </div>
    </div>
    
    <script>
        // å·¥å…·æ•°æ®å’Œé…ç½®
        let allTools = [];
        let filteredTools = [];
        let currentPage = 1;
        const itemsPerPage = 12;
        let lastScanTime = null;
        let scanRootPath = '/';
        let isScanning = false;
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½é…ç½®
            loadConfig();
            
            // ç§»é™¤æ‰€æœ‰å®šæ—¶æ‰«æ
            // åªä¿ç•™æ‰‹åŠ¨æ‰«æåŠŸèƒ½
        });
        
        // å¼€å§‹æ‰«æ
        function startScan() {
            if (isScanning) {
                alert('æ‰«ææ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™...');
                return;
            }
            
            isScanning = true;
            updateStatus('æ‰«æä¸­...', 'warning');
            
            const scanBtn = document.getElementById('scanBtn');
            scanBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ‰«æä¸­';
            scanBtn.disabled = true;
            
            // æ¸…ç©ºä¹‹å‰çš„å·¥å…·
            allTools = [];
            filteredTools = [];
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('initialState').style.display = 'none';
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('toolsGrid').innerHTML = `
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨æ‰«æå·¥å…·æ–‡ä»¶å¤¹...</p>
                    <p id="scanProgress" style="font-size: 0.85rem; color: #666; margin-top: 10px;"></p>
                </div>
            `;
            
            // å¼€å§‹é€’å½’æ‰«æ
            scanFoldersRecursive(scanRootPath)
                .then(tools => {
                    allTools = tools;
                    filteredTools = [...tools];
                    
                    // æ›´æ–°çŠ¶æ€
                    updateStatus('æ‰«æå®Œæˆ', 'success');
                    scanBtn.innerHTML = '<i class="fas fa-search"></i> æ‰«æå·¥å…·';
                    scanBtn.disabled = false;
                    isScanning = false;
                    
                    // è®°å½•æ‰«ææ—¶é—´
                    lastScanTime = new Date();
                    updateLastScanTime();
                    
                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    updateStats();
                    
                    // æ˜¾ç¤ºç›®å½•ç»“æ„
                    showFolderStructure();
                    
                    // æ¸²æŸ“å·¥å…·
                    renderTools();
                    
                    // ä¿å­˜é…ç½®
                    saveConfig();
                })
                .catch(error => {
                    console.error('æ‰«æå¤±è´¥:', error);
                    updateStatus('æ‰«æå¤±è´¥', 'error');
                    scanBtn.innerHTML = '<i class="fas fa-redo"></i> é‡è¯•';
                    scanBtn.disabled = false;
                    isScanning = false;
                    
                    document.getElementById('toolsGrid').innerHTML = `
                        <div class="error-box">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>æ‰«æå¤±è´¥</strong>
                            <p>${error.message || 'æœªçŸ¥é”™è¯¯'}</p>
                            <button class="btn btn-primary" onclick="startScan()" style="margin-top: 10px;">
                                <i class="fas fa-redo"></i> é‡æ–°æ‰«æ
                            </button>
                        </div>
                    `;
                });
        }
        
        // é€’å½’æ‰«ææ–‡ä»¶å¤¹
        async function scanFoldersRecursive(basePath) {
            const tools = [];
            const foldersToScan = [basePath];
            const scannedFolders = new Set();
            let scannedCount = 0;
            
            // æ›´æ–°æ‰«æè¿›åº¦
            function updateProgress() {
                const progressElement = document.getElementById('scanProgress');
                if (progressElement) {
                    progressElement.textContent = `å·²æ‰«æ ${scannedCount} ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° ${tools.length} ä¸ªå·¥å…·`;
                }
            }
            
            // æ‰«æé˜Ÿåˆ—ä¸­çš„æ–‡ä»¶å¤¹
            while (foldersToScan.length > 0) {
                const currentPath = foldersToScan.shift();
                
                // é¿å…é‡å¤æ‰«æ
                if (scannedFolders.has(currentPath)) {
                    continue;
                }
                
                scannedFolders.add(currentPath);
                scannedCount++;
                updateProgress();
                
                try {
                    // å°è¯•è·å–å½“å‰æ–‡ä»¶å¤¹çš„å†…å®¹
                    const folderContents = await getFolderContents(currentPath);
                    
                    for (const item of folderContents) {
                        if (item.type === 'directory') {
                            // å¦‚æœæ˜¯ç›®å½•ï¼Œæ·»åŠ åˆ°æ‰«æé˜Ÿåˆ—
                            const subPath = currentPath === '/' ? item.name : `${currentPath}/${item.name}`;
                            foldersToScan.push(subPath);
                            
                            // æ£€æŸ¥è¯¥ç›®å½•æ˜¯å¦æœ‰index.html
                            const hasIndexHtml = await checkForIndexHtml(subPath);
                            if (hasIndexHtml) {
                                // è¿™æ˜¯ä¸€ä¸ªå·¥å…·
                                tools.push({
                                    name: formatToolName(item.name),
                                    folder: subPath,
                                    path: subPath,
                                    icon: getToolIcon(item.name),
                                    description: getToolDescription(item.name),
                                    isDirectTool: true
                                });
                            }
                        } else if (item.name === 'index.html' && currentPath !== '/') {
                            // åœ¨å­ç›®å½•ä¸­æ‰¾åˆ°index.htmlï¼Œæ£€æŸ¥æ˜¯å¦å·²æ·»åŠ è¯¥å·¥å…·
                            const existingTool = tools.find(t => t.path === currentPath);
                            if (!existingTool) {
                                // è¿™æ˜¯ä¸€ä¸ªå·¥å…·
                                tools.push({
                                    name: formatToolName(getLastPathSegment(currentPath)),
                                    folder: currentPath,
                                    path: currentPath,
                                    icon: getToolIcon(getLastPathSegment(currentPath)),
                                    description: getToolDescription(getLastPathSegment(currentPath)),
                                    isDirectTool: true
                                });
                            }
                        }
                    }
                } catch (error) {
                    console.warn(`æ— æ³•è®¿é—®æ–‡ä»¶å¤¹ ${currentPath}:`, error.message);
                    // ç»§ç»­æ‰«æå…¶ä»–æ–‡ä»¶å¤¹
                }
            }
            
            // é¢å¤–æ£€æŸ¥æ ¹ç›®å½•ä¸‹çš„ç›´æ¥å·¥å…·
            try {
                const rootContents = await getFolderContents('/');
                for (const item of rootContents) {
                    if (item.type === 'directory') {
                        // æ£€æŸ¥æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹æ˜¯å¦æœ‰index.html
                        const hasIndexHtml = await checkForIndexHtml(item.name);
                        if (hasIndexHtml) {
                            // æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ 
                            const existingTool = tools.find(t => t.path === item.name);
                            if (!existingTool) {
                                tools.push({
                                    name: formatToolName(item.name),
                                    folder: item.name,
                                    path: item.name,
                                    icon: getToolIcon(item.name),
                                    description: getToolDescription(item.name),
                                    isDirectTool: true
                                });
                            }
                        }
                    }
                }
            } catch (error) {
                console.warn('æ— æ³•æ£€æŸ¥æ ¹ç›®å½•:', error);
            }
            
            // æ›´æ–°æœ€ç»ˆæ‰«æè®¡æ•°
            document.getElementById('scannedFolders').textContent = scannedCount;
            return tools;
        }
        
        // è·å–æ–‡ä»¶å¤¹å†…å®¹
        async function getFolderContents(path) {
            // ç”±äºGitHub Pagesçš„é™åˆ¶ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è·å–ç›®å½•åˆ—è¡¨
            // æ‰€ä»¥ä½¿ç”¨å°è¯•è®¿é—®index.htmlçš„æ–¹å¼æ¥åˆ¤æ–­
            // è¿™æ˜¯ä¸€ä¸ªç®€åŒ–å®ç°ï¼Œå®é™…ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ–¹æ³•
            
            // å¦‚æœæ˜¯æ ¹ç›®å½•ï¼Œå°è¯•è·å–å·²çŸ¥çš„æ–‡ä»¶å¤¹
            if (path === '/') {
                // å°è¯•è·å–å¸¸è§çš„æ–‡ä»¶å¤¹
                const commonFolders = [
                    'novel-titles', 'fiction-titles', 'mobile-tool', 'mobile-novel-tool',
                    'text', 'text1', 'text2', 'å°è¯´', 'å·¥å…·', 'tools', 'apps'
                ];
                
                const results = [];
                for (const folder of commonFolders) {
                    try {
                        const response = await fetch(`/${folder}/index.html`, { method: 'HEAD' });
                        if (response.ok) {
                            results.push({ type: 'directory', name: folder });
                        }
                    } catch (error) {
                        // å¿½ç•¥é”™è¯¯
                    }
                }
                return results;
            } else {
                // å¯¹äºå­ç›®å½•ï¼Œæˆ‘ä»¬å‡è®¾å®ƒå¯èƒ½æœ‰index.html
                // å®é™…ä¸­è¿™é‡Œå¯èƒ½éœ€è¦æ›´å¤æ‚çš„å®ç°
                return [];
            }
        }
        
        // æ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦æœ‰index.html
        async function checkForIndexHtml(path) {
            try {
                const response = await fetch(`/${path}/index.html`, { method: 'HEAD' });
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        // è·å–è·¯å¾„çš„æœ€åä¸€æ®µ
        function getLastPathSegment(path) {
            const segments = path.split('/').filter(s => s);
            return segments.length > 0 ? segments[segments.length - 1] : '';
        }
        
        // æ ¼å¼åŒ–å·¥å…·åç§°
        function formatToolName(folderName) {
            if (!folderName) return 'æœªçŸ¥å·¥å…·';
            
            return folderName
                .replace(/-/g, ' ')
                .replace(/_/g, ' ')
                .replace(/\b\w/g, l => l.toUpperCase())
                .replace(/novel/gi, 'å°è¯´')
                .replace(/tool/gi, 'å·¥å…·')
                .replace(/mobile/gi, 'æ‰‹æœº')
                .replace(/fiction/gi, 'å°è¯´')
                .replace(/title/gi, 'æ ‡é¢˜')
                .replace(/text/gi, 'æ–‡æœ¬');
        }
        
        // è·å–å·¥å…·å›¾æ ‡
        function getToolIcon(folderName) {
            const lowerName = folderName.toLowerCase();
            
            if (lowerName.includes('novel') || lowerName.includes('fiction') || lowerName.includes('å°è¯´')) return 'ğŸ“–';
            if (lowerName.includes('mobile') || lowerName.includes('phone') || lowerName.includes('æ‰‹æœº')) return 'ğŸ“±';
            if (lowerName.includes('excel') || lowerName.includes('è¡¨æ ¼')) return 'ğŸ“Š';
            if (lowerName.includes('text') || lowerName.includes('æ–‡æœ¬')) return 'âœï¸';
            if (lowerName.includes('image') || lowerName.includes('å›¾ç‰‡')) return 'ğŸ–¼ï¸';
            if (lowerName.includes('calc') || lowerName.includes('è®¡ç®—')) return 'ğŸ§®';
            if (lowerName.includes('note') || lowerName.includes('è®°äº‹')) return 'ğŸ“';
            
            return 'ğŸ› ï¸';
        }
        
        // è·å–å·¥å…·æè¿°
        function getToolDescription(folderName) {
            const lowerName = folderName.toLowerCase();
            
            if (lowerName.includes('novel') || lowerName.includes('fiction') || lowerName.includes('å°è¯´')) {
                return 'å°è¯´åˆ›ä½œç›¸å…³å·¥å…·';
            } else if (lowerName.includes('mobile') || lowerName.includes('phone') || lowerName.includes('æ‰‹æœº')) {
                return 'æ‰‹æœºç«¯ä¼˜åŒ–å·¥å…·';
            } else if (lowerName.includes('excel') || lowerName.includes('è¡¨æ ¼')) {
                return 'Excelæ•°æ®å¤„ç†å·¥å…·';
            } else if (lowerName.includes('text') || lowerName.includes('æ–‡æœ¬')) {
                return 'æ–‡æœ¬å¤„ç†å’Œç¼–è¾‘å·¥å…·';
            } else if (lowerName.includes('image') || lowerName.includes('å›¾ç‰‡')) {
                return 'å›¾ç‰‡ç¼–è¾‘å’Œå¤„ç†å·¥å…·';
            }
            
            return 'ä¸€ä¸ªå®ç”¨çš„åœ¨çº¿å·¥å…·';
        }
        
        // æ›´æ–°çŠ¶æ€
        function updateStatus(text, type = 'info') {
            const statusText = document.getElementById('statusText');
            const statusDot = document.getElementById('statusDot');
            
            statusText.textContent = text;
            
            switch (type) {
                case 'success':
                    statusDot.style.background = '#4CAF50';
                    break;
                case 'warning':
                    statusDot.style.background = '#FF9800';
                    break;
                case 'error':
                    statusDot.style.background = '#f44336';
                    break;
                default:
                    statusDot.style.background = '#667eea';
            }
        }
        
        // æ˜¾ç¤ºç›®å½•ç»“æ„
        function showFolderStructure() {
            if (allTools.length === 0) {
                document.getElementById('folderStructure').style.display = 'none';
                return;
            }
            
            // æŒ‰è·¯å¾„åˆ†ç»„å·¥å…·
            const pathMap = {};
            allTools.forEach(tool => {
                const path = tool.path;
                if (!pathMap[path]) {
                    pathMap[path] = [];
                }
                pathMap[path].push(tool);
            });
            
            // ç”Ÿæˆç›®å½•ç»“æ„HTML
            let structureHTML = '';
            
            // æŒ‰è·¯å¾„æ’åº
            const sortedPaths = Object.keys(pathMap).sort();
            
            sortedPaths.forEach(path => {
                const tools = pathMap[path];
                const displayPath = path === '/' ? 'æ ¹ç›®å½•' : path;
                
                structureHTML += `<div class="folder-item"><i class="fas fa-folder"></i> ${displayPath}`;
                tools.forEach(tool => {
                    structureHTML += `<div style="margin-left: 20px; margin-top: 5px;">
                        <i class="fas fa-file-alt"></i> ${tool.name} (${tool.folder})
                    </div>`;
                });
                structureHTML += `</div>`;
            });
            
            document.getElementById('structureContent').innerHTML = structureHTML;
            document.getElementById('folderStructure').style.display = 'block';
        }
        
        // æ¸²æŸ“å·¥å…·
        function renderTools() {
            const toolsGrid = document.getElementById('toolsGrid');
            const emptyState = document.getElementById('emptyState');
            
            // å¦‚æœæ²¡æœ‰å·¥å…·ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€
            if (filteredTools.length === 0) {
                toolsGrid.style.display = 'none';
                emptyState.style.display = 'block';
                updatePagination();
                return;
            }
            
            // éšè—ç©ºçŠ¶æ€
            emptyState.style.display = 'none';
            toolsGrid.style.display = 'grid';
            
            // è®¡ç®—åˆ†é¡µ
            const totalPages = Math.ceil(filteredTools.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredTools.length);
            const pageTools = filteredTools.slice(startIndex, endIndex);
            
            // ç”Ÿæˆå·¥å…·å¡ç‰‡HTML
            let gridHTML = '';
            
            pageTools.forEach(tool => {
                gridHTML += `
                    <a href="${tool.path}/" class="tool-card" title="${tool.name}">
                        <div class="tool-icon">${tool.icon}</div>
                        <div class="tool-name">${tool.name}</div>
                        <div class="tool-folder">${tool.path}</div>
                        <div class="tool-desc">${tool.description}</div>
                    </a>
                `;
            });
            
            toolsGrid.innerHTML = gridHTML;
            
            // æ›´æ–°åˆ†é¡µæ§ä»¶
            updatePagination();
        }
        
        // æ›´æ–°åˆ†é¡µæ§ä»¶
        function updatePagination() {
            const totalPages = Math.ceil(filteredTools.length / itemsPerPage);
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const pageInfoText = document.getElementById('pageInfoText');
            const pageInfo = document.getElementById('pageInfo');
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = currentPage <= 1;
            nextBtn.disabled = currentPage >= totalPages;
            
            // æ›´æ–°é¡µé¢ä¿¡æ¯
            pageInfoText.textContent = `ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ`;
            pageInfo.textContent = `${currentPage}/${totalPages}`;
        }
        
        // ä¸Šä¸€é¡µ
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                renderTools();
            }
        }
        
        // ä¸‹ä¸€é¡µ
        function nextPage() {
            const totalPages = Math.ceil(filteredTools.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                renderTools();
            }
        }
        
        // æœç´¢å·¥å…·
        function searchTools() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            currentPage = 1;
            
            if (!searchTerm) {
                filteredTools = [...allTools];
            } else {
                filteredTools = allTools.filter(tool => {
                    return tool.name.toLowerCase().includes(searchTerm) ||
                           tool.folder.toLowerCase().includes(searchTerm) ||
                           tool.path.toLowerCase().includes(searchTerm) ||
                           tool.description.toLowerCase().includes(searchTerm);
                });
            }
            
            // é‡æ–°æ¸²æŸ“å·¥å…·
            renderTools();
        }
        
        // æ¸…é™¤æœç´¢
        function clearSearch() {
            document.getElementById('searchInput').value = '';
            filteredTools = [...allTools];
            currentPage = 1;
            renderTools();
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            document.getElementById('totalTools').textContent = allTools.length;
        }
        
        // æ›´æ–°ä¸Šæ¬¡æ‰«ææ—¶é—´
        function updateLastScanTime() {
            if (!lastScanTime) return;
            
            const now = new Date();
            const diffMs = now - lastScanTime;
            const diffMins = Math.floor(diffMs / 60000);
            
            let displayTime;
            if (diffMins < 1) {
                displayTime = 'åˆšåˆš';
            } else if (diffMins < 60) {
                displayTime = `${diffMins}åˆ†é’Ÿå‰`;
            } else {
                const diffHours = Math.floor(diffMins / 60);
                displayTime = `${diffHours}å°æ—¶å‰`;
            }
            
            document.getElementById('lastUpdate').textContent = displayTime;
        }
        
        // æ˜¾ç¤ºæ‰«æé…ç½®
        function showScanConfig() {
            document.getElementById('scanConfigPanel').style.display = 'flex';
        }
        
        // éšè—æ‰«æé…ç½®
        function hideScanConfig() {
            document.getElementById('scanConfigPanel').style.display = 'none';
        }
        
        // æ›´æ–°æ‰«æé…ç½®
        function updateScanConfig() {
            const rootPathInput = document.getElementById('rootPath');
            scanRootPath = rootPathInput.value.trim() || '/';
            alert(`æ‰«ææ ¹ç›®å½•å·²æ›´æ–°ä¸º: ${scanRootPath}`);
            saveConfig();
        }
        
        // ä¿å­˜é…ç½®åˆ°æœ¬åœ°å­˜å‚¨
        function saveConfig() {
            const config = {
                scanRootPath: scanRootPath,
                lastScanTime: lastScanTime ? lastScanTime.toISOString() : null,
                toolsCount: allTools.length
            };
            localStorage.setItem('toolNavConfig', JSON.stringify(config));
        }
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½é…ç½®
        function loadConfig() {
            try {
                const saved = localStorage.getItem('toolNavConfig');
                if (saved) {
                    const config = JSON.parse(saved);
                    scanRootPath = config.scanRootPath || '/';
                    
                    if (config.lastScanTime) {
                        lastScanTime = new Date(config.lastScanTime);
                        updateLastScanTime();
                    }
                    
                    // æ›´æ–°è¾“å…¥æ¡†
                    document.getElementById('rootPath').value = scanRootPath;
                }
            } catch (error) {
                console.warn('åŠ è½½é…ç½®å¤±è´¥:', error);
            }
        }
        
        // æ˜¾ç¤ºå¸®åŠ©
        function showHelp() {
            alert('ä½¿ç”¨å¸®åŠ©ï¼š\n\n' +
                  '1. ç‚¹å‡»"æ‰«æå·¥å…·"æŒ‰é’®å¼€å§‹æ‰«ææ‰€æœ‰æ–‡ä»¶å¤¹å’Œå­ç›®å½•\n' +
                  '2. ç³»ç»Ÿä¼šé€’å½’æ‰«ææ‰€æœ‰ç›®å½•ï¼ŒæŸ¥æ‰¾åŒ…å«index.htmlçš„æ–‡ä»¶å¤¹\n' +
                  '3. ä½¿ç”¨æœç´¢æ¡†å¯ä»¥å¿«é€ŸæŸ¥æ‰¾å·¥å…·\n' +
                  '4. å·¥å…·è¾ƒå¤šæ—¶ä¼šè‡ªåŠ¨åˆ†é¡µæ˜¾ç¤º\n' +
                  '5. ç‚¹å‡»é…ç½®æŒ‰é’®å¯ä»¥è®¾ç½®æ‰«ææ ¹ç›®å½•\n\n' +
                  'æ³¨æ„ï¼šæ‰«æéœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…');
        }
        
        // æ‰‹åŠ¨æ·»åŠ æµ‹è¯•å·¥å…·ï¼ˆç”¨äºè°ƒè¯•ï¼‰
        function addTestTools() {
            allTools = [
                {
                    name: "å°è¯´æ ‡é¢˜å·¥å…·",
                    folder: "novel-titles",
                    path: "novel-titles",
                    icon: "ğŸ“–",
                    description: "ç¼–è¾‘ã€å¤åˆ¶ã€å¯¼å‡ºå°è¯´æ ‡é¢˜åˆ°Excel",
                    isDirectTool: true
                },
                {
                    name: "æ‰‹æœºå®ç”¨å·¥å…·",
                    folder: "mobile-tool",
                    path: "mobile-tool",
                    icon: "ğŸ“±",
                    description: "è®¡ç®—å™¨ã€è®°äº‹æœ¬ç­‰å¸¸ç”¨å·¥å…·",
                    isDirectTool: true
                },
                {
                    name: "æ–‡æœ¬å·¥å…·1",
                    folder: "text1",
                    path: "text/text1",
                    icon: "âœï¸",
                    description: "æ–‡æœ¬å¤„ç†å·¥å…·1",
                    isDirectTool: true
                },
                {
                    name: "æ–‡æœ¬å·¥å…·2",
                    folder: "text2",
                    path: "text/text2",
                    icon: "âœï¸",
                    description: "æ–‡æœ¬å¤„ç†å·¥å…·2",
                    isDirectTool: true
                }
            ];
            
            filteredTools = [...allTools];
            updateStatus('æµ‹è¯•æ•°æ®å·²åŠ è½½', 'success');
            updateStats();
            showFolderStructure();
            renderTools();
        }
    </script>
</body>
</html>
>>>>>>> 4f27a110f4e7e9edfa569723a06fb3e5d22e5f39